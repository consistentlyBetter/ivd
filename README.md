<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- knit with rmarkdown::render("README.Rmd", output_format = "md_document") -->

Individual Variance Detection
=============================

<!-- badges: start -->

[![R-CMD-check](https://github.com/ph-rast/ivd/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ph-rast/ivd/actions/workflows/R-CMD-check.yaml)
[![codecov](https://codecov.io/gh/ph-rast/consistentlyBetter-CanvasApp/graph/badge.svg?token=V6PK2J7AL9)](https://codecov.io/gh/ph-rast/consistentlyBetter-CanvasApp)
<!-- badges: end -->

SSranef is an R package for random effects selection that corresponds to
the models described in Rodriguez, Williams, and Rast (2021).
Specifically, `ivd_alpha()` fits a random intercepts model with a
spike-and-slab prior on the random effects and `ivd_beta()` fits a model
with both random intercepts and random slopes, with a spike-and-slab
prior on the random effects for the slope. The function `ivd_mv()` fits
a multivariate mixed-effects models for two outcomes and places a
spike-and-slab prior on the random slope for each outcome.

This package is repurposed from the orginal verision at
[josue-rodriguez/SSranef](https://www.github.com/josue-rodriguez/SSranef)

Installation
------------

This package can be installed with

    # install.packages("devtools")
    devtools::install_github("consistentlybetter/ivd")

Example
-------

    library(ivd)

    d <- mlmRev::Hsb82

Alpha model
-----------

    d$y <- c(scale(d$mAch))

    alpha <- ivd_alpha(y = d$y, unit = d$school)
    #> Compiling model graph
    #>    Resolving undeclared variables
    #>    Allocating nodes
    #> Graph information:
    #>    Observed stochastic nodes: 7185
    #>    Unobserved stochastic nodes: 323
    #>    Total graph size: 15483
    #> 
    #> Initializing model
    #> 
    #>   |                                                          |                                                  |   0%  |                                                          |+                                                 |   2%  |                                                          |++                                                |   4%  |                                                          |+++                                               |   6%  |                                                          |++++                                              |   8%  |                                                          |+++++                                             |  10%  |                                                          |++++++                                            |  12%  |                                                          |+++++++                                           |  14%  |                                                          |++++++++                                          |  16%  |                                                          |+++++++++                                         |  18%  |                                                          |++++++++++                                        |  20%  |                                                          |+++++++++++                                       |  22%  |                                                          |++++++++++++                                      |  24%  |                                                          |+++++++++++++                                     |  26%  |                                                          |++++++++++++++                                    |  28%  |                                                          |+++++++++++++++                                   |  30%  |                                                          |++++++++++++++++                                  |  32%  |                                                          |+++++++++++++++++                                 |  34%  |                                                          |++++++++++++++++++                                |  36%  |                                                          |+++++++++++++++++++                               |  38%  |                                                          |++++++++++++++++++++                              |  40%  |                                                          |+++++++++++++++++++++                             |  42%  |                                                          |++++++++++++++++++++++                            |  44%  |                                                          |+++++++++++++++++++++++                           |  46%  |                                                          |++++++++++++++++++++++++                          |  48%  |                                                          |+++++++++++++++++++++++++                         |  50%  |                                                          |++++++++++++++++++++++++++                        |  52%  |                                                          |+++++++++++++++++++++++++++                       |  54%  |                                                          |++++++++++++++++++++++++++++                      |  56%  |                                                          |+++++++++++++++++++++++++++++                     |  58%  |                                                          |++++++++++++++++++++++++++++++                    |  60%  |                                                          |+++++++++++++++++++++++++++++++                   |  62%  |                                                          |++++++++++++++++++++++++++++++++                  |  64%  |                                                          |+++++++++++++++++++++++++++++++++                 |  66%  |                                                          |++++++++++++++++++++++++++++++++++                |  68%  |                                                          |+++++++++++++++++++++++++++++++++++               |  70%  |                                                          |++++++++++++++++++++++++++++++++++++              |  72%  |                                                          |+++++++++++++++++++++++++++++++++++++             |  74%  |                                                          |++++++++++++++++++++++++++++++++++++++            |  76%  |                                                          |+++++++++++++++++++++++++++++++++++++++           |  78%  |                                                          |++++++++++++++++++++++++++++++++++++++++          |  80%  |                                                          |+++++++++++++++++++++++++++++++++++++++++         |  82%  |                                                          |++++++++++++++++++++++++++++++++++++++++++        |  84%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++       |  86%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++      |  88%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++     |  90%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++    |  92%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++   |  94%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++++ |  98%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%

    posterior_summary(alpha, ci = 0.90, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_alpha(y = d$y, unit = d$school)
    #> 
    #>       Post_mean q05   q95 
    #> alpha 0.05      -0.01 0.11
    #> sigma 0.91       0.90 0.93
    #> tau   0.54       0.47 0.61

    ranef_summary(alpha, ci = 0.95, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_alpha(y = d$y, unit = d$school)
    #> 
    #>            Post_mean q025  q975  PIP  BF_10   BF_01
    #> theta_1224 -1.03     -1.48 -0.60 1.00     Inf 0.00 
    #> theta_1288 -1.18     -1.49 -0.86 1.00     Inf 0.00 
    #> theta_1296 -1.00     -1.26 -0.74 1.00     Inf 0.00 
    #> theta_1308 -1.18     -1.46 -0.88 1.00     Inf 0.00 
    #> theta_1317 -0.98     -1.23 -0.73 1.00     Inf 0.00 
    #> theta_1358 -0.76     -1.11 -0.42 1.00 1999.00 0.00 
    #> theta_1374 -0.68     -0.95 -0.41 1.00     Inf 0.00 
    #> theta_1433 -0.03     -0.30  0.10 0.27    0.38 2.66 
    #> theta_1436 -0.45     -0.71 -0.17 0.99   96.56 0.01 
    #> theta_1461 -0.13     -0.52  0.02 0.50    0.99 1.01 
    #> theta_1462 -0.09     -0.50  0.05 0.40    0.66 1.52 
    #> theta_1477 -0.22     -0.49  0.00 0.79    3.78 0.26 
    #> theta_1499 -0.76     -1.07 -0.45 1.00     Inf 0.00 
    #> theta_1637 -0.53     -0.82 -0.24 1.00  265.67 0.00 
    #> theta_1906 -0.50     -0.75 -0.24 1.00 1332.33 0.00 
    #> theta_1909 -0.65     -0.91 -0.40 1.00     Inf 0.00 
    #> theta_1942 -0.62     -0.89 -0.34 1.00 1332.33 0.00 
    #> theta_1946 -0.46     -0.79  0.00 0.97   28.41 0.04 
    #> theta_2030 -0.26     -0.66  0.00 0.74    2.86 0.35 
    #> theta_2208 -0.52     -0.78 -0.24 1.00  443.44 0.00 
    #> theta_2277  0.03     -0.06  0.29 0.24    0.32 3.12 
    #> theta_2305 -0.13     -0.54  0.01 0.51    1.03 0.97 
    #> theta_2336 -0.65     -0.91 -0.39 1.00     Inf 0.00 
    #> theta_2458  0.10      0.00  0.41 0.49    0.96 1.05 
    #> theta_2467 -0.52     -0.76 -0.29 1.00     Inf 0.00 
    #> theta_2526  0.05     -0.04  0.33 0.32    0.46 2.16 
    #> theta_2626  0.00     -0.19  0.23 0.24    0.32 3.10 
    #> theta_2629 -0.02     -0.22  0.09 0.23    0.30 3.29 
    #> theta_2639 -0.06     -0.40  0.07 0.34    0.50 1.98 
    #> theta_2651 -0.56     -0.78 -0.33 1.00     Inf 0.00 
    #> theta_2655  0.13      0.00  0.44 0.58    1.37 0.73 
    #> theta_2658  0.01     -0.10  0.19 0.21    0.27 3.77 
    #> theta_2755 -0.88     -1.15 -0.61 1.00     Inf 0.00 
    #> theta_2768 -0.53     -0.80 -0.27 1.00  999.00 0.00 
    #> theta_2771 -0.06     -0.33  0.01 0.35    0.53 1.89 
    #> theta_2818  0.01     -0.07  0.21 0.22    0.28 3.56 
    #> theta_2917 -0.34     -0.63  0.00 0.91    9.61 0.10 
    #> theta_2990 -0.34     -0.62  0.00 0.92   11.90 0.08 
    #> theta_2995 -0.75     -1.01 -0.48 1.00     Inf 0.00 
    #> theta_3013 -0.06     -0.38  0.04 0.34    0.53 1.90 
    #> theta_3020 -0.35     -0.63  0.00 0.94   15.19 0.07 
    #> theta_3039 -0.51     -0.74 -0.27 1.00  799.00 0.00 
    #> theta_3088 -0.02     -0.27  0.07 0.23    0.31 3.26 
    #> theta_3152 -0.19     -0.49  0.00 0.70    2.38 0.42 
    #> theta_3332 -0.23     -0.70  0.00 0.66    1.95 0.51 
    #> theta_3351  0.01     -0.15  0.20 0.22    0.28 3.57 
    #> theta_3377  0.05     -0.03  0.34 0.32    0.47 2.13 
    #> theta_3427 -0.23     -0.53  0.00 0.78    3.44 0.29 
    #> theta_3498  0.06     -0.03  0.36 0.36    0.55 1.81 
    #> theta_3499  0.01     -0.11  0.22 0.21    0.26 3.82 
    #> theta_3533 -0.01     -0.24  0.16 0.24    0.31 3.24 
    #> theta_3610  0.01     -0.11  0.23 0.21    0.27 3.66 
    #> theta_3657  0.02     -0.13  0.26 0.25    0.33 3.02 
    #> theta_3688 -0.01     -0.17  0.11 0.19    0.24 4.15 
    #> theta_3705 -0.74     -0.99 -0.50 1.00     Inf 0.00 
    #> theta_3716 -0.02     -0.26  0.11 0.24    0.32 3.14 
    #> theta_3838  0.02     -0.18  0.29 0.26    0.36 2.81 
    #> theta_3881 -0.36     -0.68  0.00 0.90    9.31 0.11 
    #> theta_3967 -0.46     -0.73 -0.17 0.99   96.56 0.01 
    #> theta_3992 -0.01     -0.17  0.09 0.19    0.24 4.16 
    #> theta_3999  0.28      0.00  0.53 0.89    8.24 0.12 
    #> theta_4042 -0.05     -0.34  0.02 0.32    0.48 2.09 
    #> theta_4173 -0.07     -0.37  0.01 0.40    0.66 1.51 
    #> theta_4223  0.00     -0.14  0.17 0.20    0.26 3.88 
    #> theta_4253  0.18      0.00  0.48 0.70    2.28 0.44 
    #> theta_4292  0.10     -0.01  0.44 0.47    0.88 1.14 
    #> theta_4325 -0.34     -0.60  0.00 0.95   19.94 0.05 
    #> theta_4350 -0.14     -0.55  0.00 0.53    1.13 0.89 
    #> theta_4383 -0.79     -1.11 -0.46 1.00     Inf 0.00 
    #> theta_4410  0.02     -0.07  0.25 0.24    0.32 3.13 
    #> theta_4420  0.47      0.00  0.80 0.97   29.08 0.03 
    #> theta_4458  0.13     -0.01  0.49 0.53    1.12 0.89 
    #> theta_4511 -0.33     -0.65  0.00 0.90    8.73 0.11 
    #> theta_4523  0.06     -0.06  0.43 0.35    0.54 1.87 
    #> theta_4530 -0.17     -0.53  0.00 0.63    1.69 0.59 
    #> theta_4642 -0.40     -0.66  0.00 0.97   37.46 0.03 
    #> theta_4868 -0.40     -0.75  0.00 0.91   10.05 0.10 
    #> theta_4931 -0.09     -0.40  0.00 0.47    0.89 1.13 
    #> theta_5192  0.02     -0.05  0.25 0.24    0.32 3.16 
    #> theta_5404  0.07     -0.02  0.37 0.38    0.62 1.62 
    #> theta_5619  0.45      0.20  0.70 0.99  189.48 0.01 
    #> theta_5640 -0.06     -0.37  0.05 0.34    0.52 1.92 
    #> theta_5650 -0.48     -0.75 -0.20 0.99  147.15 0.01 
    #> theta_5667  0.02     -0.11  0.30 0.24    0.32 3.09 
    #> theta_5720  0.10     -0.01  0.44 0.47    0.88 1.13 
    #> theta_5761 -0.62     -0.87 -0.37 1.00     Inf 0.00 
    #> theta_5762 -0.36     -0.60  0.00 0.98   39.40 0.03 
    #> theta_5783 -0.02     -0.23  0.09 0.23    0.30 3.29 
    #> theta_5815 -0.69     -0.96 -0.42 1.00     Inf 0.00 
    #> theta_5819  0.04     -0.13  0.41 0.32    0.47 2.14 
    #> theta_5838  0.46      0.19  0.72 0.99  147.15 0.01 
    #> theta_5937  0.52      0.27  0.77 1.00 3999.00 0.00 
    #> theta_6074 -0.04     -0.33  0.04 0.28    0.39 2.54 
    #> theta_6089  0.14      0.00  0.48 0.57    1.32 0.76 
    #> theta_6144  0.08      0.00  0.36 0.42    0.72 1.39 
    #> theta_6170  0.06     -0.08  0.44 0.36    0.57 1.76 
    #> theta_6291  0.01     -0.11  0.23 0.23    0.31 3.27 
    #> theta_6366  0.02     -0.06  0.27 0.25    0.33 3.00 
    #> theta_6397  0.03     -0.10  0.32 0.28    0.39 2.54 
    #> theta_6415  0.39      0.00  0.64 0.97   34.09 0.03 
    #> theta_6443  0.11      0.00  0.42 0.52    1.10 0.91 
    #> theta_6464 -0.22     -0.54  0.00 0.74    2.83 0.35 
    #> theta_6469 -0.01     -0.22  0.10 0.21    0.26 3.82 
    #> theta_6484  0.01     -0.12  0.17 0.21    0.26 3.86 
    #> theta_6578 -0.19     -0.50  0.00 0.71    2.39 0.42 
    #> theta_6600  0.00     -0.19  0.16 0.22    0.29 3.48 
    #> theta_6808  0.21      0.00  0.52 0.74    2.79 0.36 
    #> theta_6816  0.20      0.00  0.50 0.73    2.65 0.38 
    #> theta_6897 -0.20     -0.64  0.00 0.61    1.58 0.63 
    #> theta_6990 -0.07     -0.44  0.04 0.36    0.55 1.81 
    #> theta_7011 -0.04     -0.34  0.07 0.29    0.42 2.40 
    #> theta_7101  0.10     -0.01  0.46 0.45    0.81 1.24 
    #> theta_7172  0.04     -0.03  0.30 0.29    0.41 2.45 
    #> theta_7232  0.28      0.00  0.53 0.89    7.81 0.13 
    #> theta_7276  0.00     -0.12  0.15 0.19    0.24 4.14 
    #> theta_7332  0.41      0.14  0.65 0.98   63.52 0.02 
    #> theta_7341  0.25      0.00  0.53 0.81    4.21 0.24 
    #> theta_7342  0.29      0.00  0.55 0.91   10.73 0.09 
    #> theta_7345  0.25      0.00  0.61 0.74    2.83 0.35 
    #> theta_7364  0.06     -0.01  0.35 0.38    0.60 1.67 
    #> theta_7635 -0.16     -0.59  0.01 0.54    1.17 0.85 
    #> theta_7688  0.46      0.00  0.86 0.93   12.61 0.08 
    #> theta_7697 -0.04     -0.31  0.04 0.28    0.38 2.64 
    #> theta_7734 -0.01     -0.17  0.09 0.19    0.23 4.38 
    #> theta_7890  0.31      0.00  0.76 0.77    3.31 0.30 
    #> theta_7919  0.89      0.60  1.19 1.00     Inf 0.00 
    #> theta_8009  0.69      0.42  0.95 1.00     Inf 0.00 
    #> theta_8150  0.49      0.10  0.80 0.98   48.38 0.02 
    #> theta_8165 -0.79     -1.13 -0.46 1.00     Inf 0.00 
    #> theta_8175  0.66      0.33  0.99 1.00  665.67 0.00 
    #> theta_8188 -0.01     -0.20  0.13 0.21    0.27 3.67 
    #> theta_8193  0.47      0.21  0.73 0.99  172.91 0.01 
    #> theta_8202  0.55      0.31  0.79 1.00 1332.33 0.00 
    #> theta_8357  0.01     -0.13  0.22 0.21    0.27 3.70 
    #> theta_8367  0.46      0.18  0.72 0.99   77.43 0.01 
    #> theta_8477 -0.07     -0.37  0.01 0.38    0.60 1.65 
    #> theta_8531  0.74      0.48  0.99 1.00     Inf 0.00 
    #> theta_8627  0.08      0.00  0.38 0.43    0.76 1.32 
    #> theta_8628  0.00     -0.13  0.16 0.20    0.25 4.06 
    #> theta_8707  0.06     -0.05  0.38 0.36    0.56 1.80 
    #> theta_8775 -0.11     -0.46  0.01 0.47    0.89 1.12 
    #> theta_8800  0.91      0.65  1.16 1.00     Inf 0.00 
    #> theta_8854 -0.49     -0.75 -0.23 1.00  234.29 0.00 
    #> theta_8857  0.12      0.00  0.41 0.53    1.14 0.88 
    #> theta_8874  0.29      0.00  0.56 0.90    8.85 0.11 
    #> theta_8946  0.30      0.00  0.55 0.93   12.65 0.08 
    #> theta_8983  0.34      0.00  0.59 0.94   16.24 0.06 
    #> theta_9021  0.74      0.51  0.98 1.00     Inf 0.00 
    #> theta_9104  0.03     -0.11  0.31 0.28    0.38 2.61 
    #> theta_9158 -0.01     -0.20  0.08 0.20    0.26 3.91 
    #> theta_9198  0.11      0.00  0.43 0.50    1.01 0.99 
    #> theta_9225 -0.15     -0.46  0.00 0.63    1.67 0.60 
    #> theta_9292  0.74      0.49  0.98 1.00     Inf 0.00 
    #> theta_9340  0.28      0.00  0.64 0.79    3.83 0.26 
    #> theta_9347  0.42      0.00  0.70 0.97   31.26 0.03 
    #> theta_9359 -0.07     -0.42  0.06 0.37    0.59 1.71 
    #> theta_9397 -0.25     -0.55  0.00 0.82    4.62 0.22 
    #> theta_9508  0.47      0.24  0.71 1.00 1332.33 0.00 
    #> theta_9550  0.80      0.49  1.10 1.00     Inf 0.00 
    #> theta_9586  0.16      0.00  0.47 0.64    1.75 0.57

    caterpillar_plot(alpha, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-4-1.png" width="100%" />

    pip_plot(alpha, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-5-1.png" width="100%" />

Beta model
----------

    beta <- ivd_beta(y = d$y, X = d$ses, unit = d$school)
    #> Compiling model graph
    #>    Resolving undeclared variables
    #>    Allocating nodes
    #> Graph information:
    #>    Observed stochastic nodes: 7185
    #>    Unobserved stochastic nodes: 486
    #>    Total graph size: 44271
    #> 
    #> Initializing model
    #> 
    #>   |                                                          |                                                  |   0%  |                                                          |+                                                 |   2%  |                                                          |++                                                |   4%  |                                                          |+++                                               |   6%  |                                                          |++++                                              |   8%  |                                                          |+++++                                             |  10%  |                                                          |++++++                                            |  12%  |                                                          |+++++++                                           |  14%  |                                                          |++++++++                                          |  16%  |                                                          |+++++++++                                         |  18%  |                                                          |++++++++++                                        |  20%  |                                                          |+++++++++++                                       |  22%  |                                                          |++++++++++++                                      |  24%  |                                                          |+++++++++++++                                     |  26%  |                                                          |++++++++++++++                                    |  28%  |                                                          |+++++++++++++++                                   |  30%  |                                                          |++++++++++++++++                                  |  32%  |                                                          |+++++++++++++++++                                 |  34%  |                                                          |++++++++++++++++++                                |  36%  |                                                          |+++++++++++++++++++                               |  38%  |                                                          |++++++++++++++++++++                              |  40%  |                                                          |+++++++++++++++++++++                             |  42%  |                                                          |++++++++++++++++++++++                            |  44%  |                                                          |+++++++++++++++++++++++                           |  46%  |                                                          |++++++++++++++++++++++++                          |  48%  |                                                          |+++++++++++++++++++++++++                         |  50%  |                                                          |++++++++++++++++++++++++++                        |  52%  |                                                          |+++++++++++++++++++++++++++                       |  54%  |                                                          |++++++++++++++++++++++++++++                      |  56%  |                                                          |+++++++++++++++++++++++++++++                     |  58%  |                                                          |++++++++++++++++++++++++++++++                    |  60%  |                                                          |+++++++++++++++++++++++++++++++                   |  62%  |                                                          |++++++++++++++++++++++++++++++++                  |  64%  |                                                          |+++++++++++++++++++++++++++++++++                 |  66%  |                                                          |++++++++++++++++++++++++++++++++++                |  68%  |                                                          |+++++++++++++++++++++++++++++++++++               |  70%  |                                                          |++++++++++++++++++++++++++++++++++++              |  72%  |                                                          |+++++++++++++++++++++++++++++++++++++             |  74%  |                                                          |++++++++++++++++++++++++++++++++++++++            |  76%  |                                                          |+++++++++++++++++++++++++++++++++++++++           |  78%  |                                                          |++++++++++++++++++++++++++++++++++++++++          |  80%  |                                                          |+++++++++++++++++++++++++++++++++++++++++         |  82%  |                                                          |++++++++++++++++++++++++++++++++++++++++++        |  84%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++       |  86%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++      |  88%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++     |  90%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++    |  92%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++   |  94%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++++ |  98%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%
    posterior_summary(beta, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_beta(y = d$y, X = d$ses, unit = d$school)
    #> 
    #>       Post_mean q05   q95 
    #> alpha -0.02     -0.06 0.03
    #> beta   0.35      0.32 0.38
    #> sigma  0.88      0.87 0.90
    #> tau1   0.32      0.29 0.36
    #> tau2   0.11      0.03 0.18
    #> rho   -0.09     -0.76 0.49

    ranef_summary(beta, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_beta(y = d$y, X = d$ses, unit = d$school)
    #> 
    #>             Post_mean q05   q95   PIP  BF_10 BF_01
    #> theta1_1224 -0.77     -1.09 -0.43   NA   NA    NA 
    #> theta1_1288 -0.76     -1.00 -0.51   NA   NA    NA 
    #> theta1_1296 -0.53     -0.75 -0.31   NA   NA    NA 
    #> theta1_1308 -0.65     -0.90 -0.40   NA   NA    NA 
    #> theta1_1317 -0.70     -0.90 -0.51   NA   NA    NA 
    #> theta1_1358 -0.40     -0.67 -0.14   NA   NA    NA 
    #> theta1_1374 -0.48     -0.69 -0.27   NA   NA    NA 
    #> theta1_1433 -0.14     -0.37  0.10   NA   NA    NA 
    #> theta1_1436 -0.31     -0.51 -0.12   NA   NA    NA 
    #> theta1_1461 -0.16     -0.40  0.08   NA   NA    NA 
    #> theta1_1462 -0.15     -0.42  0.11   NA   NA    NA 
    #> theta1_1477 -0.05     -0.26  0.15   NA   NA    NA 
    #> theta1_1499 -0.41     -0.65 -0.16   NA   NA    NA 
    #> theta1_1637 -0.29     -0.51 -0.07   NA   NA    NA 
    #> theta1_1906 -0.30     -0.50 -0.10   NA   NA    NA 
    #> theta1_1909 -0.40     -0.61 -0.20   NA   NA    NA 
    #> theta1_1942 -0.37     -0.58 -0.16   NA   NA    NA 
    #> theta1_1946 -0.28     -0.52 -0.03   NA   NA    NA 
    #> theta1_2030 -0.24     -0.48  0.01   NA   NA    NA 
    #> theta1_2208 -0.39     -0.59 -0.18   NA   NA    NA 
    #> theta1_2277  0.12     -0.09  0.33   NA   NA    NA 
    #> theta1_2305 -0.05     -0.30  0.19   NA   NA    NA 
    #> theta1_2336 -0.52     -0.71 -0.32   NA   NA    NA 
    #> theta1_2458  0.09     -0.11  0.29   NA   NA    NA 
    #> theta1_2467 -0.28     -0.53 -0.07   NA   NA    NA 
    #> theta1_2526  0.04     -0.17  0.24   NA   NA    NA 
    #> theta1_2626  0.01     -0.23  0.25   NA   NA    NA 
    #> theta1_2629  0.01     -0.18  0.20   NA   NA    NA 
    #> theta1_2639 -0.09     -0.34  0.16   NA   NA    NA 
    #> theta1_2651 -0.28     -0.47 -0.09   NA   NA    NA 
    #> theta1_2655  0.07     -0.12  0.26   NA   NA    NA 
    #> theta1_2658  0.13     -0.06  0.31   NA   NA    NA 
    #> theta1_2755 -0.47     -0.71 -0.24   NA   NA    NA 
    #> theta1_2768 -0.28     -0.51 -0.07   NA   NA    NA 
    #> theta1_2771  0.08     -0.12  0.27   NA   NA    NA 
    #> theta1_2818  0.05     -0.14  0.24   NA   NA    NA 
    #> theta1_2917 -0.35     -0.56 -0.15   NA   NA    NA 
    #> theta1_2990 -0.24     -0.44 -0.04   NA   NA    NA 
    #> theta1_2995 -0.50     -0.70 -0.30   NA   NA    NA 
    #> theta1_3013 -0.14     -0.37  0.10   NA   NA    NA 
    #> theta1_3020 -0.32     -0.52 -0.13   NA   NA    NA 
    #> theta1_3039 -0.32     -0.51 -0.12   NA   NA    NA 
    #> theta1_3088  0.20      0.00  0.43   NA   NA    NA 
    #> theta1_3152 -0.06     -0.25  0.13   NA   NA    NA 
    #> theta1_3332 -0.10     -0.39  0.19   NA   NA    NA 
    #> theta1_3351 -0.04     -0.27  0.18   NA   NA    NA 
    #> theta1_3377  0.21      0.01  0.42   NA   NA    NA 
    #> theta1_3427 -0.12     -0.31  0.08   NA   NA    NA 
    #> theta1_3498  0.20      0.00  0.40   NA   NA    NA 
    #> theta1_3499 -0.03     -0.24  0.18   NA   NA    NA 
    #> theta1_3533 -0.03     -0.26  0.21   NA   NA    NA 
    #> theta1_3610  0.08     -0.14  0.29   NA   NA    NA 
    #> theta1_3657  0.15     -0.08  0.38   NA   NA    NA 
    #> theta1_3688 -0.02     -0.21  0.17   NA   NA    NA 
    #> theta1_3705 -0.47     -0.67 -0.28   NA   NA    NA 
    #> theta1_3716  0.05     -0.17  0.27   NA   NA    NA 
    #> theta1_3838  0.06     -0.19  0.32   NA   NA    NA 
    #> theta1_3881 -0.14     -0.37  0.09   NA   NA    NA 
    #> theta1_3967 -0.23     -0.43 -0.03   NA   NA    NA 
    #> theta1_3992  0.15     -0.04  0.34   NA   NA    NA 
    #> theta1_3999  0.20      0.01  0.38   NA   NA    NA 
    #> theta1_4042  0.00     -0.20  0.20   NA   NA    NA 
    #> theta1_4173 -0.04     -0.23  0.16   NA   NA    NA 
    #> theta1_4223 -0.03     -0.23  0.18   NA   NA    NA 
    #> theta1_4253  0.33      0.14  0.51   NA   NA    NA 
    #> theta1_4292  0.28      0.08  0.48   NA   NA    NA 
    #> theta1_4325 -0.10     -0.31  0.10   NA   NA    NA 
    #> theta1_4350 -0.20     -0.44  0.06   NA   NA    NA 
    #> theta1_4383 -0.45     -0.71 -0.19   NA   NA    NA 
    #> theta1_4410  0.05     -0.15  0.24   NA   NA    NA 
    #> theta1_4420  0.30      0.05  0.55   NA   NA    NA 
    #> theta1_4458  0.13     -0.09  0.35   NA   NA    NA 
    #> theta1_4511 -0.12     -0.34  0.11   NA   NA    NA 
    #> theta1_4523  0.14     -0.12  0.38   NA   NA    NA 
    #> theta1_4530 -0.21     -0.43  0.01   NA   NA    NA 
    #> theta1_4642 -0.21     -0.41 -0.02   NA   NA    NA 
    #> theta1_4868 -0.33     -0.57 -0.08   NA   NA    NA 
    #> theta1_4931 -0.10     -0.28  0.08   NA   NA    NA 
    #> theta1_5192  0.01     -0.17  0.20   NA   NA    NA 
    #> theta1_5404  0.20      0.01  0.39   NA   NA    NA 
    #> theta1_5619  0.30      0.09  0.51   NA   NA    NA 
    #> theta1_5640 -0.12     -0.33  0.08   NA   NA    NA 
    #> theta1_5650 -0.30     -0.51 -0.09   NA   NA    NA 
    #> theta1_5667  0.08     -0.15  0.31   NA   NA    NA 
    #> theta1_5720  0.13     -0.08  0.34   NA   NA    NA 
    #> theta1_5761 -0.38     -0.58 -0.18   NA   NA    NA 
    #> theta1_5762 -0.18     -0.38  0.00   NA   NA    NA 
    #> theta1_5783  0.02     -0.18  0.21   NA   NA    NA 
    #> theta1_5815 -0.35     -0.57 -0.13   NA   NA    NA 
    #> theta1_5819  0.25     -0.03  0.53   NA   NA    NA 
    #> theta1_5838  0.39      0.19  0.60   NA   NA    NA 
    #> theta1_5937  0.31      0.11  0.51   NA   NA    NA 
    #> theta1_6074 -0.16     -0.36  0.04   NA   NA    NA 
    #> theta1_6089  0.20     -0.01  0.41   NA   NA    NA 
    #> theta1_6144  0.10     -0.09  0.28   NA   NA    NA 
    #> theta1_6170  0.23     -0.02  0.47   NA   NA    NA 
    #> theta1_6291 -0.02     -0.24  0.20   NA   NA    NA 
    #> theta1_6366  0.23      0.04  0.42   NA   NA    NA 
    #> theta1_6397  0.21     -0.02  0.44   NA   NA    NA 
    #> theta1_6415  0.27      0.07  0.47   NA   NA    NA 
    #> theta1_6443  0.16     -0.04  0.36   NA   NA    NA 
    #> theta1_6464 -0.18     -0.39  0.02   NA   NA    NA 
    #> theta1_6469  0.00     -0.21  0.21   NA   NA    NA 
    #> theta1_6484  0.09     -0.10  0.29   NA   NA    NA 
    #> theta1_6578 -0.09     -0.28  0.11   NA   NA    NA 
    #> theta1_6600  0.08     -0.14  0.31   NA   NA    NA 
    #> theta1_6808  0.20      0.00  0.40   NA   NA    NA 
    #> theta1_6816  0.23      0.03  0.43   NA   NA    NA 
    #> theta1_6897 -0.08     -0.36  0.19   NA   NA    NA 
    #> theta1_6990 -0.06     -0.29  0.17   NA   NA    NA 
    #> theta1_7011  0.03     -0.19  0.26   NA   NA    NA 
    #> theta1_7101  0.17     -0.05  0.40   NA   NA    NA 
    #> theta1_7172  0.10     -0.09  0.29   NA   NA    NA 
    #> theta1_7232  0.32      0.14  0.49   NA   NA    NA 
    #> theta1_7276  0.12     -0.06  0.31   NA   NA    NA 
    #> theta1_7332  0.40      0.20  0.59   NA   NA    NA 
    #> theta1_7341  0.25      0.05  0.45   NA   NA    NA 
    #> theta1_7342  0.22      0.04  0.41   NA   NA    NA 
    #> theta1_7345  0.33      0.10  0.56   NA   NA    NA 
    #> theta1_7364  0.16     -0.02  0.34   NA   NA    NA 
    #> theta1_7635 -0.18     -0.44  0.07   NA   NA    NA 
    #> theta1_7688  0.37      0.09  0.65   NA   NA    NA 
    #> theta1_7697 -0.11     -0.31  0.08   NA   NA    NA 
    #> theta1_7734  0.09     -0.09  0.27   NA   NA    NA 
    #> theta1_7890  0.25     -0.03  0.54   NA   NA    NA 
    #> theta1_7919  0.64      0.39  0.87   NA   NA    NA 
    #> theta1_8009  0.52      0.30  0.74   NA   NA    NA 
    #> theta1_8150  0.26     -0.01  0.51   NA   NA    NA 
    #> theta1_8165 -0.43     -0.69 -0.18   NA   NA    NA 
    #> theta1_8175  0.44      0.20  0.69   NA   NA    NA 
    #> theta1_8188  0.03     -0.18  0.24   NA   NA    NA 
    #> theta1_8193  0.36      0.15  0.56   NA   NA    NA 
    #> theta1_8202  0.48      0.29  0.67   NA   NA    NA 
    #> theta1_8357  0.11     -0.11  0.33   NA   NA    NA 
    #> theta1_8367  0.33      0.12  0.54   NA   NA    NA 
    #> theta1_8477  0.01     -0.18  0.20   NA   NA    NA 
    #> theta1_8531  0.54      0.33  0.75   NA   NA    NA 
    #> theta1_8627  0.16     -0.03  0.34   NA   NA    NA 
    #> theta1_8628  0.07     -0.12  0.25   NA   NA    NA 
    #> theta1_8707  0.02     -0.21  0.25   NA   NA    NA 
    #> theta1_8775 -0.23     -0.45 -0.02   NA   NA    NA 
    #> theta1_8800  0.86      0.65  1.06   NA   NA    NA 
    #> theta1_8854 -0.18     -0.37  0.02   NA   NA    NA 
    #> theta1_8857  0.21      0.04  0.39   NA   NA    NA 
    #> theta1_8874  0.11     -0.09  0.33   NA   NA    NA 
    #> theta1_8946  0.20      0.02  0.39   NA   NA    NA 
    #> theta1_8983  0.30      0.11  0.49   NA   NA    NA 
    #> theta1_9021  0.51      0.31  0.71   NA   NA    NA 
    #> theta1_9104  0.15     -0.08  0.38   NA   NA    NA 
    #> theta1_9158 -0.02     -0.22  0.17   NA   NA    NA 
    #> theta1_9198  0.16     -0.04  0.36   NA   NA    NA 
    #> theta1_9225 -0.18     -0.37  0.01   NA   NA    NA 
    #> theta1_9292  0.69      0.50  0.89   NA   NA    NA 
    #> theta1_9340  0.29      0.05  0.53   NA   NA    NA 
    #> theta1_9347  0.50      0.28  0.70   NA   NA    NA 
    #> theta1_9359 -0.14     -0.37  0.08   NA   NA    NA 
    #> theta1_9397 -0.25     -0.43 -0.06   NA   NA    NA 
    #> theta1_9508  0.54      0.36  0.73   NA   NA    NA 
    #> theta1_9550  0.61      0.37  0.85   NA   NA    NA 
    #> theta1_9586  0.10     -0.09  0.30   NA   NA    NA 
    #> theta2_1224 -0.02     -0.20  0.12 0.47 0.88  1.14 
    #> theta2_1288  0.02     -0.07  0.18 0.46 0.86  1.17 
    #> theta2_1296  0.01     -0.09  0.12 0.43 0.76  1.31 
    #> theta2_1308  0.01     -0.11  0.14 0.46 0.84  1.19 
    #> theta2_1317 -0.02     -0.19  0.07 0.45 0.83  1.21 
    #> theta2_1358  0.02     -0.08  0.18 0.48 0.94  1.07 
    #> theta2_1374 -0.01     -0.15  0.09 0.45 0.81  1.23 
    #> theta2_1433 -0.02     -0.16  0.08 0.46 0.87  1.15 
    #> theta2_1436 -0.01     -0.14  0.08 0.46 0.85  1.17 
    #> theta2_1461  0.04     -0.05  0.22 0.54 1.16  0.87 
    #> theta2_1462  0.04     -0.06  0.24 0.54 1.17  0.85 
    #> theta2_1477 -0.09     -0.32  0.01 0.69 2.21  0.45 
    #> theta2_1499  0.02     -0.08  0.16 0.49 0.95  1.05 
    #> theta2_1637  0.00     -0.11  0.11 0.46 0.85  1.18 
    #> theta2_1906 -0.02     -0.16  0.07 0.48 0.92  1.08 
    #> theta2_1909 -0.04     -0.24  0.06 0.52 1.09  0.92 
    #> theta2_1942  0.02     -0.08  0.15 0.47 0.90  1.11 
    #> theta2_1946 -0.05     -0.25  0.04 0.56 1.28  0.78 
    #> theta2_2030 -0.01     -0.15  0.10 0.48 0.91  1.10 
    #> theta2_2208  0.00     -0.10  0.11 0.44 0.77  1.29 
    #> theta2_2277  0.01     -0.10  0.14 0.47 0.87  1.14 
    #> theta2_2305  0.01     -0.10  0.14 0.49 0.96  1.05 
    #> theta2_2336  0.01     -0.11  0.13 0.47 0.88  1.14 
    #> theta2_2458 -0.02     -0.15  0.06 0.47 0.90  1.11 
    #> theta2_2467 -0.13     -0.39  0.00 0.75 2.94  0.34 
    #> theta2_2526 -0.01     -0.14  0.09 0.47 0.90  1.11 
    #> theta2_2626  0.01     -0.09  0.14 0.46 0.86  1.17 
    #> theta2_2629  0.02     -0.08  0.16 0.49 0.96  1.04 
    #> theta2_2639 -0.02     -0.16  0.08 0.50 0.99  1.01 
    #> theta2_2651  0.00     -0.12  0.10 0.45 0.81  1.23 
    #> theta2_2655  0.00     -0.10  0.12 0.46 0.84  1.19 
    #> theta2_2658 -0.04     -0.23  0.04 0.55 1.22  0.82 
    #> theta2_2755 -0.02     -0.18  0.08 0.46 0.85  1.18 
    #> theta2_2768 -0.06     -0.27  0.04 0.56 1.29  0.77 
    #> theta2_2771  0.00     -0.10  0.10 0.46 0.87  1.15 
    #> theta2_2818  0.00     -0.09  0.12 0.46 0.84  1.19 
    #> theta2_2917 -0.02     -0.18  0.07 0.48 0.91  1.10 
    #> theta2_2990 -0.03     -0.21  0.06 0.50 1.00  1.00 
    #> theta2_2995 -0.01     -0.14  0.10 0.46 0.85  1.18 
    #> theta2_3013  0.03     -0.06  0.19 0.50 1.02  0.98 
    #> theta2_3020  0.00     -0.11  0.12 0.46 0.86  1.17 
    #> theta2_3039 -0.07     -0.28  0.02 0.60 1.48  0.68 
    #> theta2_3088  0.04     -0.04  0.24 0.53 1.15  0.87 
    #> theta2_3152 -0.02     -0.17  0.07 0.49 0.95  1.05 
    #> theta2_3332  0.00     -0.14  0.12 0.49 0.96  1.05 
    #> theta2_3351 -0.02     -0.16  0.08 0.49 0.94  1.06 
    #> theta2_3377 -0.03     -0.19  0.07 0.50 1.02  0.98 
    #> theta2_3427 -0.01     -0.15  0.08 0.47 0.90  1.11 
    #> theta2_3498 -0.04     -0.20  0.04 0.53 1.15  0.87 
    #> theta2_3499  0.00     -0.10  0.12 0.46 0.85  1.18 
    #> theta2_3533  0.03     -0.07  0.19 0.50 1.00  1.00 
    #> theta2_3610  0.01     -0.11  0.13 0.47 0.90  1.12 
    #> theta2_3657  0.01     -0.09  0.15 0.47 0.90  1.11 
    #> theta2_3688  0.02     -0.05  0.17 0.48 0.91  1.10 
    #> theta2_3705  0.04     -0.03  0.20 0.53 1.12  0.89 
    #> theta2_3716  0.03     -0.06  0.18 0.51 1.04  0.96 
    #> theta2_3838  0.01     -0.09  0.15 0.50 0.98  1.02 
    #> theta2_3881  0.02     -0.07  0.18 0.51 1.02  0.98 
    #> theta2_3967  0.01     -0.09  0.13 0.46 0.84  1.19 
    #> theta2_3992 -0.07     -0.28  0.02 0.63 1.73  0.58 
    #> theta2_3999 -0.02     -0.17  0.07 0.51 1.03  0.97 
    #> theta2_4042  0.01     -0.08  0.16 0.48 0.94  1.07 
    #> theta2_4173  0.02     -0.06  0.17 0.50 1.00  1.00 
    #> theta2_4223 -0.01     -0.15  0.08 0.49 0.96  1.05 
    #> theta2_4253 -0.06     -0.27  0.02 0.60 1.50  0.66 
    #> theta2_4292  0.00     -0.12  0.12 0.45 0.81  1.23 
    #> theta2_4325 -0.06     -0.26  0.03 0.57 1.31  0.76 
    #> theta2_4350  0.02     -0.07  0.18 0.50 1.01  0.99 
    #> theta2_4383  0.00     -0.12  0.13 0.48 0.91  1.10 
    #> theta2_4410 -0.03     -0.19  0.05 0.50 1.01  0.99 
    #> theta2_4420 -0.01     -0.14  0.12 0.48 0.94  1.06 
    #> theta2_4458  0.02     -0.08  0.17 0.48 0.94  1.07 
    #> theta2_4511  0.11      0.00  0.35 0.74 2.83  0.35 
    #> theta2_4523  0.01     -0.10  0.14 0.48 0.93  1.07 
    #> theta2_4530  0.04     -0.04  0.22 0.55 1.20  0.83 
    #> theta2_4642  0.01     -0.09  0.15 0.48 0.93  1.08 
    #> theta2_4868  0.02     -0.07  0.19 0.51 1.03  0.97 
    #> theta2_4931  0.06     -0.02  0.25 0.59 1.44  0.69 
    #> theta2_5192  0.02     -0.06  0.16 0.49 0.95  1.06 
    #> theta2_5404  0.00     -0.11  0.11 0.48 0.91  1.10 
    #> theta2_5619 -0.03     -0.20  0.06 0.52 1.07  0.94 
    #> theta2_5640  0.00     -0.12  0.12 0.48 0.94  1.07 
    #> theta2_5650 -0.02     -0.15  0.07 0.46 0.85  1.17 
    #> theta2_5667 -0.01     -0.14  0.10 0.48 0.94  1.07 
    #> theta2_5720 -0.01     -0.14  0.09 0.48 0.94  1.07 
    #> theta2_5761  0.05     -0.04  0.22 0.55 1.22  0.82 
    #> theta2_5762 -0.01     -0.13  0.08 0.46 0.84  1.20 
    #> theta2_5783  0.04     -0.05  0.22 0.55 1.24  0.81 
    #> theta2_5815 -0.01     -0.15  0.06 0.45 0.80  1.24 
    #> theta2_5819  0.02     -0.07  0.19 0.51 1.04  0.96 
    #> theta2_5838 -0.01     -0.14  0.10 0.46 0.85  1.17 
    #> theta2_5937  0.00     -0.13  0.12 0.49 0.96  1.04 
    #> theta2_6074 -0.02     -0.17  0.07 0.48 0.94  1.07 
    #> theta2_6089 -0.04     -0.21  0.05 0.55 1.25  0.80 
    #> theta2_6144 -0.01     -0.14  0.07 0.47 0.89  1.13 
    #> theta2_6170  0.00     -0.09  0.11 0.45 0.81  1.24 
    #> theta2_6291  0.01     -0.08  0.15 0.49 0.96  1.04 
    #> theta2_6366 -0.02     -0.15  0.07 0.47 0.90  1.11 
    #> theta2_6397  0.00     -0.10  0.13 0.46 0.86  1.16 
    #> theta2_6415  0.00     -0.12  0.11 0.46 0.86  1.17 
    #> theta2_6443 -0.03     -0.20  0.05 0.52 1.10  0.91 
    #> theta2_6464  0.03     -0.04  0.19 0.49 0.97  1.03 
    #> theta2_6469  0.01     -0.09  0.14 0.47 0.90  1.11 
    #> theta2_6484  0.01     -0.08  0.12 0.46 0.83  1.20 
    #> theta2_6578  0.01     -0.07  0.15 0.47 0.89  1.12 
    #> theta2_6600 -0.03     -0.19  0.06 0.51 1.03  0.97 
    #> theta2_6808  0.02     -0.06  0.18 0.50 1.01  0.99 
    #> theta2_6816  0.00     -0.10  0.12 0.47 0.87  1.15 
    #> theta2_6897  0.07     -0.03  0.29 0.63 1.67  0.60 
    #> theta2_6990 -0.01     -0.14  0.10 0.47 0.87  1.15 
    #> theta2_7011  0.03     -0.06  0.19 0.50 0.99  1.01 
    #> theta2_7101  0.01     -0.09  0.13 0.47 0.90  1.11 
    #> theta2_7172  0.01     -0.09  0.12 0.47 0.90  1.11 
    #> theta2_7232  0.01     -0.09  0.13 0.46 0.85  1.18 
    #> theta2_7276  0.02     -0.07  0.17 0.50 0.99  1.01 
    #> theta2_7332 -0.04     -0.21  0.04 0.54 1.16  0.86 
    #> theta2_7341 -0.05     -0.26  0.04 0.59 1.41  0.71 
    #> theta2_7342  0.00     -0.10  0.13 0.47 0.89  1.12 
    #> theta2_7345 -0.01     -0.15  0.10 0.48 0.93  1.08 
    #> theta2_7364 -0.03     -0.18  0.06 0.49 0.97  1.03 
    #> theta2_7635  0.02     -0.08  0.16 0.49 0.97  1.03 
    #> theta2_7688  0.01     -0.10  0.15 0.47 0.90  1.11 
    #> theta2_7697 -0.01     -0.12  0.10 0.46 0.86  1.17 
    #> theta2_7734  0.01     -0.08  0.12 0.46 0.86  1.16 
    #> theta2_7890 -0.01     -0.16  0.11 0.50 1.01  0.99 
    #> theta2_7919  0.01     -0.11  0.16 0.46 0.84  1.19 
    #> theta2_8009  0.00     -0.14  0.13 0.47 0.89  1.12 
    #> theta2_8150  0.09     -0.03  0.32 0.66 1.91  0.52 
    #> theta2_8165  0.03     -0.07  0.19 0.51 1.03  0.97 
    #> theta2_8175 -0.01     -0.15  0.12 0.48 0.91  1.09 
    #> theta2_8188  0.02     -0.07  0.16 0.49 0.97  1.03 
    #> theta2_8193  0.00     -0.14  0.10 0.46 0.87  1.15 
    #> theta2_8202 -0.04     -0.22  0.05 0.54 1.17  0.86 
    #> theta2_8357  0.02     -0.08  0.17 0.49 0.95  1.05 
    #> theta2_8367 -0.02     -0.18  0.07 0.50 0.98  1.02 
    #> theta2_8477  0.02     -0.06  0.17 0.48 0.93  1.07 
    #> theta2_8531 -0.01     -0.14  0.10 0.47 0.87  1.15 
    #> theta2_8627 -0.01     -0.14  0.08 0.47 0.87  1.14 
    #> theta2_8628  0.01     -0.08  0.12 0.45 0.81  1.24 
    #> theta2_8707  0.00     -0.12  0.11 0.48 0.91  1.09 
    #> theta2_8775  0.00     -0.10  0.10 0.44 0.78  1.28 
    #> theta2_8800 -0.08     -0.31  0.03 0.58 1.41  0.71 
    #> theta2_8854  0.04     -0.04  0.19 0.52 1.09  0.92 
    #> theta2_8857  0.02     -0.08  0.16 0.47 0.89  1.12 
    #> theta2_8874 -0.01     -0.14  0.09 0.49 0.97  1.03 
    #> theta2_8946  0.07     -0.02  0.29 0.62 1.65  0.60 
    #> theta2_8983 -0.02     -0.15  0.08 0.46 0.87  1.16 
    #> theta2_9021  0.00     -0.12  0.12 0.45 0.82  1.22 
    #> theta2_9104  0.03     -0.07  0.22 0.52 1.09  0.92 
    #> theta2_9158  0.03     -0.03  0.19 0.52 1.08  0.92 
    #> theta2_9198  0.00     -0.11  0.10 0.47 0.89  1.12 
    #> theta2_9225  0.05     -0.02  0.24 0.59 1.43  0.70 
    #> theta2_9292 -0.04     -0.23  0.06 0.52 1.09  0.92 
    #> theta2_9340  0.01     -0.11  0.15 0.48 0.94  1.07 
    #> theta2_9347 -0.01     -0.15  0.10 0.47 0.87  1.14 
    #> theta2_9359  0.02     -0.07  0.17 0.49 0.96  1.04 
    #> theta2_9397 -0.01     -0.13  0.09 0.47 0.89  1.12 
    #> theta2_9508 -0.03     -0.19  0.06 0.49 0.94  1.06 
    #> theta2_9550  0.01     -0.11  0.16 0.46 0.85  1.17 
    #> theta2_9586 -0.01     -0.14  0.08 0.48 0.92  1.09

    caterpillar_plot(beta, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-8-1.png" width="100%" />

    pip_plot(beta, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-9-1.png" width="100%" />

Multivariate model
------------------

    mv_data <- gen_mv_data(5, 5)
    str(mv_data)
    #> 'data.frame':    25 obs. of  4 variables:
    #>  $ y1: num  -0.143 -0.867 -3.358 7.559 1.977 ...
    #>  $ y2: num  1.2303 3.3592 0.0618 3.9768 1.3244 ...
    #>  $ x : num  0 1 0 1 0 1 0 1 0 1 ...
    #>  $ id: Factor w/ 5 levels "1","2","3","4",..: 1 1 1 1 1 2 2 2 2 2 ...

    mv_model <- ivd_mv(Y = cbind(mv_data$y1, mv_data$y2),
                            X = mv_data$x,
                            unit = mv_data$id,
                            burnin = 100,
                            iter = 500,
                            chains = 4)
    #> Compiling model graph
    #>    Resolving undeclared variables
    #>    Allocating nodes
    #> Graph information:
    #>    Observed stochastic nodes: 25
    #>    Unobserved stochastic nodes: 23
    #>    Total graph size: 338
    #> 
    #> Initializing model
    #> 
    #>   |                                                          |                                                  |   0%  |                                                          |+                                                 |   2%  |                                                          |++                                                |   4%  |                                                          |+++                                               |   6%  |                                                          |++++                                              |   8%  |                                                          |+++++                                             |  10%  |                                                          |++++++                                            |  12%  |                                                          |+++++++                                           |  14%  |                                                          |++++++++                                          |  16%  |                                                          |+++++++++                                         |  18%  |                                                          |++++++++++                                        |  20%  |                                                          |+++++++++++                                       |  22%  |                                                          |++++++++++++                                      |  24%  |                                                          |+++++++++++++                                     |  26%  |                                                          |++++++++++++++                                    |  28%  |                                                          |+++++++++++++++                                   |  30%  |                                                          |++++++++++++++++                                  |  32%  |                                                          |+++++++++++++++++                                 |  34%  |                                                          |++++++++++++++++++                                |  36%  |                                                          |+++++++++++++++++++                               |  38%  |                                                          |++++++++++++++++++++                              |  40%  |                                                          |+++++++++++++++++++++                             |  42%  |                                                          |++++++++++++++++++++++                            |  44%  |                                                          |+++++++++++++++++++++++                           |  46%  |                                                          |++++++++++++++++++++++++                          |  48%  |                                                          |+++++++++++++++++++++++++                         |  50%  |                                                          |++++++++++++++++++++++++++                        |  52%  |                                                          |+++++++++++++++++++++++++++                       |  54%  |                                                          |++++++++++++++++++++++++++++                      |  56%  |                                                          |+++++++++++++++++++++++++++++                     |  58%  |                                                          |++++++++++++++++++++++++++++++                    |  60%  |                                                          |+++++++++++++++++++++++++++++++                   |  62%  |                                                          |++++++++++++++++++++++++++++++++                  |  64%  |                                                          |+++++++++++++++++++++++++++++++++                 |  66%  |                                                          |++++++++++++++++++++++++++++++++++                |  68%  |                                                          |+++++++++++++++++++++++++++++++++++               |  70%  |                                                          |++++++++++++++++++++++++++++++++++++              |  72%  |                                                          |+++++++++++++++++++++++++++++++++++++             |  74%  |                                                          |++++++++++++++++++++++++++++++++++++++            |  76%  |                                                          |+++++++++++++++++++++++++++++++++++++++           |  78%  |                                                          |++++++++++++++++++++++++++++++++++++++++          |  80%  |                                                          |+++++++++++++++++++++++++++++++++++++++++         |  82%  |                                                          |++++++++++++++++++++++++++++++++++++++++++        |  84%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++       |  86%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++      |  88%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++     |  90%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++    |  92%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++   |  94%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++++ |  98%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%

    posterior_summary(mv_model)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_mv(Y = cbind(mv_data$y1, mv_data$y2), X = mv_data$x, unit = mv_data$id, 
    #>     burnin = 100, iter = 500, chains = 4)
    #> 
    #>         Post_mean q05   q95  
    #> B_1_1    2.65      1.00  4.21
    #> B_1_2    2.73      0.06  5.26
    #> B_2_1    3.95      2.92  4.96
    #> B_2_2    3.65     -0.24  7.22
    #> rb_1_2   0.01     -0.98  0.98
    #> rb_1_3   0.02     -0.96  0.98
    #> rb_1_4   0.17     -0.99  0.99
    #> rb_2_3  -0.03     -0.98  0.98
    #> rb_2_4   0.49     -0.94  0.99
    #> rb_3_4  -0.06     -0.98  0.99
    #> rw       0.48      0.17  0.74
    #> sigma_1  3.51      2.69  4.66
    #> sigma_2  2.18      1.55  3.18
    #> Tau_1_1  6.32      0.25 25.10
    #> Tau_2_2  8.89      0.27 31.20
    #> Tau_3_3  8.13      0.24 30.95
    #> Tau_4_4 20.76      1.61 66.10

Priors
------

Priors can be passed on to either of the `ivd` functions through a named
list and using JAGS code, e.g.,

    # change prior for mean intercept
    priors <- list(alpha = "alpha ~ dt(0, 1, 3)",
                   # for each jth unit, change prior probability of inclusion
                   gamma = "gamma[j] ~ dbern(0.75)") 

    fit <- ivd_alpha(y = d$y, unit = d$school, priors = priors)
    #> Compiling model graph
    #>    Resolving undeclared variables
    #>    Allocating nodes
    #> Graph information:
    #>    Observed stochastic nodes: 7185
    #>    Unobserved stochastic nodes: 323
    #>    Total graph size: 15482
    #> 
    #> Initializing model
    #> 
    #>   |                                                          |                                                  |   0%  |                                                          |+                                                 |   2%  |                                                          |++                                                |   4%  |                                                          |+++                                               |   6%  |                                                          |++++                                              |   8%  |                                                          |+++++                                             |  10%  |                                                          |++++++                                            |  12%  |                                                          |+++++++                                           |  14%  |                                                          |++++++++                                          |  16%  |                                                          |+++++++++                                         |  18%  |                                                          |++++++++++                                        |  20%  |                                                          |+++++++++++                                       |  22%  |                                                          |++++++++++++                                      |  24%  |                                                          |+++++++++++++                                     |  26%  |                                                          |++++++++++++++                                    |  28%  |                                                          |+++++++++++++++                                   |  30%  |                                                          |++++++++++++++++                                  |  32%  |                                                          |+++++++++++++++++                                 |  34%  |                                                          |++++++++++++++++++                                |  36%  |                                                          |+++++++++++++++++++                               |  38%  |                                                          |++++++++++++++++++++                              |  40%  |                                                          |+++++++++++++++++++++                             |  42%  |                                                          |++++++++++++++++++++++                            |  44%  |                                                          |+++++++++++++++++++++++                           |  46%  |                                                          |++++++++++++++++++++++++                          |  48%  |                                                          |+++++++++++++++++++++++++                         |  50%  |                                                          |++++++++++++++++++++++++++                        |  52%  |                                                          |+++++++++++++++++++++++++++                       |  54%  |                                                          |++++++++++++++++++++++++++++                      |  56%  |                                                          |+++++++++++++++++++++++++++++                     |  58%  |                                                          |++++++++++++++++++++++++++++++                    |  60%  |                                                          |+++++++++++++++++++++++++++++++                   |  62%  |                                                          |++++++++++++++++++++++++++++++++                  |  64%  |                                                          |+++++++++++++++++++++++++++++++++                 |  66%  |                                                          |++++++++++++++++++++++++++++++++++                |  68%  |                                                          |+++++++++++++++++++++++++++++++++++               |  70%  |                                                          |++++++++++++++++++++++++++++++++++++              |  72%  |                                                          |+++++++++++++++++++++++++++++++++++++             |  74%  |                                                          |++++++++++++++++++++++++++++++++++++++            |  76%  |                                                          |+++++++++++++++++++++++++++++++++++++++           |  78%  |                                                          |++++++++++++++++++++++++++++++++++++++++          |  80%  |                                                          |+++++++++++++++++++++++++++++++++++++++++         |  82%  |                                                          |++++++++++++++++++++++++++++++++++++++++++        |  84%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++       |  86%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++      |  88%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++     |  90%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++    |  92%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++   |  94%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%  |                                                          |+++++++++++++++++++++++++++++++++++++++++++++++++ |  98%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%
    #>   |                                                          |                                                  |   0%  |                                                          |*                                                 |   2%  |                                                          |**                                                |   4%  |                                                          |***                                               |   6%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  10%  |                                                          |******                                            |  12%  |                                                          |*******                                           |  14%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  18%  |                                                          |**********                                        |  20%  |                                                          |***********                                       |  22%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  26%  |                                                          |**************                                    |  28%  |                                                          |***************                                   |  30%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  34%  |                                                          |******************                                |  36%  |                                                          |*******************                               |  38%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  42%  |                                                          |**********************                            |  44%  |                                                          |***********************                           |  46%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  50%  |                                                          |**************************                        |  52%  |                                                          |***************************                       |  54%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  58%  |                                                          |******************************                    |  60%  |                                                          |*******************************                   |  62%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  66%  |                                                          |**********************************                |  68%  |                                                          |***********************************               |  70%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  74%  |                                                          |**************************************            |  76%  |                                                          |***************************************           |  78%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  82%  |                                                          |******************************************        |  84%  |                                                          |*******************************************       |  86%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  90%  |                                                          |**********************************************    |  92%  |                                                          |***********************************************   |  94%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  98%  |                                                          |**************************************************| 100%
    ranef_summary(fit)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_alpha(y = d$y, unit = d$school, priors = priors)
    #> 
    #>            Post_mean q05   q95   PIP  BF_10   BF_01
    #> theta_1224 -0.97     -1.33 -0.61 1.00     Inf 0.00 
    #> theta_1288 -1.13     -1.39 -0.87 1.00     Inf 0.00 
    #> theta_1296 -0.96     -1.17 -0.75 1.00     Inf 0.00 
    #> theta_1308 -1.14     -1.38 -0.90 1.00     Inf 0.00 
    #> theta_1317 -0.94     -1.15 -0.73 1.00     Inf 0.00 
    #> theta_1358 -0.72     -1.01 -0.44 1.00     Inf 0.00 
    #> theta_1374 -0.65     -0.87 -0.43 1.00     Inf 0.00 
    #> theta_1433 -0.04     -0.28  0.12 0.53    1.11 0.90 
    #> theta_1436 -0.42     -0.63 -0.21 0.99  132.33 0.01 
    #> theta_1461 -0.16     -0.47  0.02 0.72    2.58 0.39 
    #> theta_1462 -0.12     -0.43  0.07 0.67    2.00 0.50 
    #> theta_1477 -0.22     -0.42  0.00 0.89    7.81 0.13 
    #> theta_1499 -0.73     -0.98 -0.48 1.00     Inf 0.00 
    #> theta_1637 -0.50     -0.74 -0.26 1.00  443.44 0.00 
    #> theta_1906 -0.46     -0.68 -0.25 1.00  570.43 0.00 
    #> theta_1909 -0.62     -0.83 -0.41 1.00     Inf 0.00 
    #> theta_1942 -0.58     -0.81 -0.35 1.00 3999.00 0.00 
    #> theta_1946 -0.44     -0.69 -0.15 0.98   53.79 0.02 
    #> theta_2030 -0.29     -0.59  0.00 0.88    7.32 0.14 
    #> theta_2208 -0.49     -0.71 -0.26 1.00 3999.00 0.00 
    #> theta_2277  0.08     -0.05  0.32 0.58    1.40 0.71 
    #> theta_2305 -0.16     -0.45  0.01 0.71    2.48 0.40 
    #> theta_2336 -0.61     -0.82 -0.40 1.00     Inf 0.00 
    #> theta_2458  0.18      0.00  0.42 0.79    3.83 0.26 
    #> theta_2467 -0.49     -0.69 -0.30 1.00     Inf 0.00 
    #> theta_2526  0.11     -0.02  0.35 0.64    1.77 0.56 
    #> theta_2626  0.02     -0.18  0.24 0.51    1.04 0.96 
    #> theta_2629 -0.02     -0.19  0.12 0.46    0.85 1.18 
    #> theta_2639 -0.08     -0.36  0.09 0.60    1.48 0.68 
    #> theta_2651 -0.53     -0.72 -0.35 1.00     Inf 0.00 
    #> theta_2655  0.21      0.00  0.44 0.84    5.39 0.19 
    #> theta_2658  0.04     -0.08  0.23 0.46    0.86 1.17 
    #> theta_2755 -0.84     -1.07 -0.62 1.00     Inf 0.00 
    #> theta_2768 -0.50     -0.72 -0.28 1.00 1999.00 0.00 
    #> theta_2771 -0.07     -0.29  0.04 0.57    1.30 0.77 
    #> theta_2818  0.05     -0.06  0.25 0.51    1.03 0.98 
    #> theta_2917 -0.33     -0.56 -0.05 0.96   26.21 0.04 
    #> theta_2990 -0.32     -0.55  0.00 0.95   19.51 0.05 
    #> theta_2995 -0.71     -0.93 -0.50 1.00     Inf 0.00 
    #> theta_3013 -0.09     -0.36  0.07 0.60    1.48 0.67 
    #> theta_3020 -0.33     -0.56 -0.04 0.96   24.32 0.04 
    #> theta_3039 -0.48     -0.67 -0.28 1.00 1332.33 0.00 
    #> theta_3088 -0.04     -0.24  0.08 0.51    1.05 0.96 
    #> theta_3152 -0.20     -0.43  0.00 0.86    6.08 0.16 
    #> theta_3332 -0.27     -0.62  0.00 0.82    4.65 0.22 
    #> theta_3351  0.03     -0.13  0.24 0.50    0.99 1.01 
    #> theta_3377  0.12     -0.02  0.37 0.67    2.07 0.48 
    #> theta_3427 -0.23     -0.46  0.00 0.88    7.02 0.14 
    #> theta_3498  0.13     -0.01  0.39 0.71    2.45 0.41 
    #> theta_3499  0.03     -0.10  0.24 0.49    0.95 1.05 
    #> theta_3533 -0.01     -0.23  0.19 0.51    1.04 0.96 
    #> theta_3610  0.04     -0.10  0.26 0.52    1.06 0.94 
    #> theta_3657  0.05     -0.09  0.28 0.51    1.06 0.94 
    #> theta_3688  0.00     -0.17  0.16 0.44    0.78 1.29 
    #> theta_3705 -0.72     -0.92 -0.51 1.00     Inf 0.00 
    #> theta_3716 -0.02     -0.24  0.13 0.48    0.92 1.09 
    #> theta_3838  0.04     -0.14  0.31 0.55    1.23 0.81 
    #> theta_3881 -0.35     -0.61  0.00 0.95   19.10 0.05 
    #> theta_3967 -0.43     -0.64 -0.21 0.99  189.48 0.01 
    #> theta_3992  0.00     -0.13  0.12 0.41    0.68 1.47 
    #> theta_3999  0.32      0.11  0.52 0.98   40.67 0.02 
    #> theta_4042 -0.07     -0.29  0.05 0.57    1.33 0.75 
    #> theta_4173 -0.09     -0.31  0.02 0.63    1.68 0.60 
    #> theta_4223  0.02     -0.11  0.19 0.45    0.81 1.24 
    #> theta_4253  0.25      0.00  0.47 0.91    9.72 0.10 
    #> theta_4292  0.18      0.00  0.44 0.78    3.56 0.28 
    #> theta_4325 -0.32     -0.54 -0.09 0.97   36.04 0.03 
    #> theta_4350 -0.18     -0.49  0.00 0.72    2.64 0.38 
    #> theta_4383 -0.75     -1.03 -0.48 1.00     Inf 0.00 
    #> theta_4410  0.07     -0.03  0.28 0.56    1.28 0.78 
    #> theta_4420  0.49      0.22  0.76 0.99   99.00 0.01 
    #> theta_4458  0.21      0.00  0.48 0.82    4.47 0.22 
    #> theta_4511 -0.32     -0.56  0.00 0.94   16.62 0.06 
    #> theta_4523  0.14     -0.03  0.44 0.69    2.22 0.45 
    #> theta_4530 -0.19     -0.46  0.00 0.78    3.53 0.28 
    #> theta_4642 -0.37     -0.58 -0.15 0.99   82.33 0.01 
    #> theta_4868 -0.39     -0.67  0.00 0.95   20.74 0.05 
    #> theta_4931 -0.11     -0.33  0.01 0.68    2.12 0.47 
    #> theta_5192  0.07     -0.03  0.28 0.57    1.31 0.76 
    #> theta_5404  0.14      0.00  0.38 0.71    2.50 0.40 
    #> theta_5619  0.48      0.27  0.68 1.00     Inf 0.00 
    #> theta_5640 -0.07     -0.31  0.07 0.56    1.29 0.78 
    #> theta_5650 -0.45     -0.67 -0.22 1.00  799.00 0.00 
    #> theta_5667  0.06     -0.11  0.32 0.57    1.31 0.76 
    #> theta_5720  0.19      0.00  0.45 0.80    4.03 0.25 
    #> theta_5761 -0.59     -0.81 -0.39 1.00     Inf 0.00 
    #> theta_5762 -0.34     -0.54 -0.12 0.98   47.78 0.02 
    #> theta_5783 -0.02     -0.21  0.09 0.45    0.83 1.20 
    #> theta_5815 -0.66     -0.89 -0.43 1.00     Inf 0.00 
    #> theta_5819  0.10     -0.11  0.42 0.63    1.68 0.59 
    #> theta_5838  0.48      0.27  0.69 1.00  362.64 0.00 
    #> theta_5937  0.54      0.33  0.75 1.00  999.00 0.00 
    #> theta_6074 -0.06     -0.28  0.06 0.52    1.10 0.91 
    #> theta_6089  0.22      0.00  0.48 0.84    5.30 0.19 
    #> theta_6144  0.15      0.00  0.37 0.75    2.95 0.34 
    #> theta_6170  0.13     -0.05  0.43 0.67    2.01 0.50 
    #> theta_6291  0.05     -0.10  0.27 0.52    1.09 0.92 
    #> theta_6366  0.07     -0.04  0.28 0.57    1.33 0.75 
    #> theta_6397  0.08     -0.08  0.34 0.59    1.45 0.69 
    #> theta_6415  0.42      0.21  0.62 1.00  221.22 0.00 
    #> theta_6443  0.20      0.00  0.44 0.84    5.26 0.19 
    #> theta_6464 -0.22     -0.46  0.00 0.86    5.93 0.17 
    #> theta_6469 -0.01     -0.20  0.15 0.48    0.91 1.10 
    #> theta_6484  0.02     -0.10  0.21 0.45    0.81 1.23 
    #> theta_6578 -0.20     -0.44  0.00 0.83    4.77 0.21 
    #> theta_6600  0.00     -0.20  0.19 0.50    0.99 1.02 
    #> theta_6808  0.28      0.00  0.51 0.93   13.60 0.07 
    #> theta_6816  0.27      0.00  0.50 0.92   11.31 0.09 
    #> theta_6897 -0.23     -0.57  0.00 0.80    4.13 0.24 
    #> theta_6990 -0.10     -0.38  0.06 0.61    1.59 0.63 
    #> theta_7011 -0.07     -0.32  0.07 0.55    1.24 0.81 
    #> theta_7101  0.18      0.00  0.46 0.77    3.37 0.30 
    #> theta_7172  0.09     -0.02  0.32 0.60    1.50 0.67 
    #> theta_7232  0.34      0.14  0.53 0.99   87.89 0.01 
    #> theta_7276  0.02     -0.10  0.19 0.44    0.77 1.29 
    #> theta_7332  0.43      0.22  0.64 1.00  399.00 0.00 
    #> theta_7341  0.31      0.00  0.53 0.95   18.90 0.05 
    #> theta_7342  0.34      0.12  0.53 0.98   59.61 0.02 
    #> theta_7345  0.33      0.00  0.59 0.93   13.08 0.08 
    #> theta_7364  0.14      0.00  0.36 0.73    2.66 0.38 
    #> theta_7635 -0.20     -0.51  0.00 0.75    3.08 0.32 
    #> theta_7688  0.49      0.15  0.80 0.98   42.96 0.02 
    #> theta_7697 -0.06     -0.28  0.07 0.53    1.14 0.88 
    #> theta_7734 -0.01     -0.15  0.12 0.41    0.71 1.42 
    #> theta_7890  0.39      0.00  0.72 0.92   11.94 0.08 
    #> theta_7919  0.90      0.65  1.14 1.00     Inf 0.00 
    #> theta_8009  0.70      0.48  0.92 1.00     Inf 0.00 
    #> theta_8150  0.51      0.25  0.76 0.99  172.91 0.01 
    #> theta_8165 -0.75     -1.02 -0.47 1.00     Inf 0.00 
    #> theta_8175  0.68      0.41  0.95 1.00     Inf 0.00 
    #> theta_8188  0.00     -0.17  0.17 0.46    0.86 1.16 
    #> theta_8193  0.49      0.27  0.71 1.00  999.00 0.00 
    #> theta_8202  0.57      0.37  0.77 1.00     Inf 0.00 
    #> theta_8357  0.03     -0.11  0.25 0.50    0.99 1.01 
    #> theta_8367  0.48      0.27  0.70 1.00  570.43 0.00 
    #> theta_8477 -0.09     -0.32  0.03 0.61    1.59 0.63 
    #> theta_8531  0.75      0.53  0.96 1.00     Inf 0.00 
    #> theta_8627  0.16      0.00  0.38 0.77    3.42 0.29 
    #> theta_8628  0.02     -0.11  0.19 0.44    0.78 1.28 
    #> theta_8707  0.12     -0.03  0.39 0.67    2.03 0.49 
    #> theta_8775 -0.14     -0.40  0.02 0.70    2.36 0.42 
    #> theta_8800  0.92      0.72  1.13 1.00     Inf 0.00 
    #> theta_8854 -0.46     -0.67 -0.25 1.00  999.00 0.00 
    #> theta_8857  0.20      0.00  0.42 0.85    5.59 0.18 
    #> theta_8874  0.34      0.12  0.54 0.99   73.07 0.01 
    #> theta_8946  0.34      0.15  0.53 0.99   73.07 0.01 
    #> theta_8983  0.38      0.17  0.58 0.99  152.85 0.01 
    #> theta_9021  0.76      0.57  0.96 1.00     Inf 0.00 
    #> theta_9104  0.07     -0.08  0.34 0.55    1.21 0.83 
    #> theta_9158 -0.02     -0.18  0.12 0.46    0.84 1.19 
    #> theta_9198  0.19      0.00  0.43 0.81    4.36 0.23 
    #> theta_9225 -0.17     -0.39  0.00 0.78    3.49 0.29 
    #> theta_9292  0.75      0.55  0.96 1.00     Inf 0.00 
    #> theta_9340  0.35      0.00  0.61 0.94   15.26 0.07 
    #> theta_9347  0.44      0.22  0.67 0.99  189.48 0.01 
    #> theta_9359 -0.10     -0.38  0.06 0.62    1.60 0.62 
    #> theta_9397 -0.25     -0.48  0.00 0.90    8.55 0.12 
    #> theta_9508  0.50      0.30  0.69 1.00 3999.00 0.00 
    #> theta_9550  0.81      0.55  1.07 1.00     Inf 0.00 
    #> theta_9586  0.25      0.00  0.46 0.90    9.34 0.11

Building on top of SSranef models
---------------------------------

The code for each model can also be extracted to make more extensive
modifications or build more complex models

    jags_model_text <- fit$model_text
    cat(jags_model_text)
    #> model{
    #>   for (i in 1:N) {
    #>     # likelihood
    #>     y[i] ~ dnorm(alpha_j[unit[i]], precision)
    #>   }
    #>   for (j in 1:J) {
    #>     gamma[j] ~ dbern(0.75)
    #>     # non-centered parameterization
    #>     alpha_raw[j] ~ dnorm(0, 1)
    #>     theta[j] <- tau * alpha_raw[j] * gamma[j]
    #>     alpha_j[j] <- alpha + theta[j]
    #>     lambda[j] <- (tau^2 / (tau^2 + sigma^2/n_j[j])) * gamma[j]
    #>   }
    #>   alpha ~ dt(0, 1, 3)
    #>   tau ~ dt(0, 1, 3)T(0, )
    #>   precision <- pow(sigma, -2)
    #>   sigma ~ dt(0, 1, 3)T(0, )
    #> }

References
==========

Rodriguez, Josue E, Donald R Williams, and Philippe Rast. 2021. “Who Is
and Is Not" Average’"? Random Effects Selection with Spike-and-Slab
Priors.” <https://doi.org/10.31234/osf.io/4d9tv>.
