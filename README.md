<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- knit with rmarkdown::render("README.Rmd", output_format = "md_document") -->

Individual Variance Detection
=============================

<!-- badges: start -->

[![R-CMD-check](https://github.com/ph-rast/ivd/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ph-rast/ivd/actions/workflows/R-CMD-check.yaml)
[![codecov](https://codecov.io/gh/consistentlyBetter/ivd/graph/badge.svg?token=SD0PM5BVIL)](https://codecov.io/gh/consistentlyBetter/ivd)
<!-- badges: end -->

*ivd* is an R package for random effects selection that corresponds to
the models described in Rodriguez, Williams, and Rast (2021).
Specifically, `ivd_alpha()` fits a random intercepts model with a
spike-and-slab prior on the random effects and `ivd_beta()` fits a model
with both random intercepts and random slopes, with a spike-and-slab
prior on the random effects for the slope. The function `ivd_mv()` fits
a multivariate mixed-effects models for two outcomes and places a
spike-and-slab prior on the random slope for each outcome.

This package is repurposed from the orginal verision at
[josue-rodriguez/SSranef](https://www.github.com/josue-rodriguez/SSranef)

Installation
------------

This package can be installed with

    # install.packages("devtools")
    devtools::install_github("consistentlybetter/ivd")

Example
-------

    library(ivd)

    d <- mlmRev::Hsb82

Alpha model
-----------

    d$y <- c(scale(d$mAch))

    alpha <- ivd_alpha(y = d$y, unit = d$school)

    posterior_summary(alpha, ci = 0.90, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_alpha(y = d$y, unit = d$school)
    #> 
    #>       Post_mean q05  q95 
    #> alpha 0.05      0.00 0.11
    #> sigma 0.91      0.90 0.92
    #> tau   0.54      0.47 0.61

    ranef_summary(alpha, ci = 0.95, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_alpha(y = d$y, unit = d$school)
    #> 
    #>            Post_mean q025  q975  PIP  BF_10   BF_01
    #> theta_1224 -1.03     -1.48 -0.59 1.00     Inf 0.00 
    #> theta_1288 -0.14     -0.53  0.00 0.52    1.07 0.94 
    #> theta_1296  0.38      0.00  0.64 0.96   24.97 0.04 
    #> theta_1308  0.12      0.00  0.42 0.53    1.13 0.89 
    #> theta_1317 -0.22     -0.55  0.00 0.75    2.98 0.34 
    #> theta_1358 -0.01     -0.22  0.11 0.22    0.29 3.48 
    #> theta_1374  0.00     -0.13  0.15 0.18    0.22 4.62 
    #> theta_1433 -0.20     -0.51  0.00 0.72    2.57 0.39 
    #> theta_1436 -0.01     -0.21  0.17 0.22    0.29 3.50 
    #> theta_1461  0.20      0.00  0.51 0.71    2.40 0.42 
    #> theta_1462  0.20      0.00  0.51 0.72    2.51 0.40 
    #> theta_1477 -0.20     -0.65  0.00 0.62    1.61 0.62 
    #> theta_1499 -0.10     -0.49  0.05 0.43    0.76 1.32 
    #> theta_1637 -0.07     -0.41  0.05 0.39    0.63 1.58 
    #> theta_1906 -0.05     -0.35  0.06 0.31    0.45 2.22 
    #> theta_1909  0.10     -0.02  0.45 0.45    0.82 1.22 
    #> theta_1942  0.04     -0.04  0.29 0.29    0.41 2.44 
    #> theta_1946  0.28      0.00  0.54 0.90    8.88 0.11 
    #> theta_2030  0.00     -0.13  0.15 0.19    0.24 4.19 
    #> theta_2208  0.40      0.10  0.64 0.98   47.78 0.02 
    #> theta_2277  0.24      0.00  0.53 0.79    3.82 0.26 
    #> theta_2305  0.29      0.00  0.55 0.90    9.39 0.11 
    #> theta_2336  0.25      0.00  0.62 0.75    2.93 0.34 
    #> theta_2458 -0.22     -0.48  0.00 0.81    4.17 0.24 
    #> theta_2467  0.06      0.00  0.35 0.36    0.57 1.74 
    #> theta_2526 -0.17     -0.60  0.01 0.57    1.32 0.76 
    #> theta_2626  0.45      0.00  0.86 0.92   11.66 0.09 
    #> theta_2629 -0.04     -0.33  0.04 0.30    0.44 2.28 
    #> theta_2639 -0.01     -0.17  0.08 0.18    0.22 4.64 
    #> theta_2651  0.32      0.00  0.76 0.78    3.54 0.28 
    #> theta_2655  0.88      0.59  1.19 1.00     Inf 0.00 
    #> theta_2658  0.68      0.41  0.94 1.00 3999.00 0.00 
    #> theta_2755  0.49      0.00  0.81 0.97   38.22 0.03 
    #> theta_2768 -0.80     -1.14 -0.47 1.00     Inf 0.00 
    #> theta_2771 -0.77     -1.07 -0.46 1.00     Inf 0.00 
    #> theta_2818  0.66      0.33  0.98 1.00 1999.00 0.00 
    #> theta_2917 -0.01     -0.20  0.14 0.22    0.28 3.55 
    #> theta_2990  0.47      0.18  0.73 0.99  128.03 0.01 
    #> theta_2995  0.55      0.31  0.78 1.00     Inf 0.00 
    #> theta_3013  0.01     -0.13  0.22 0.23    0.30 3.31 
    #> theta_3020  0.46      0.18  0.73 0.99  141.86 0.01 
    #> theta_3039 -0.08     -0.38  0.02 0.43    0.76 1.31 
    #> theta_3088  0.73      0.47  0.99 1.00     Inf 0.00 
    #> theta_3152  0.08     -0.01  0.37 0.42    0.73 1.38 
    #> theta_3332  0.00     -0.13  0.16 0.20    0.25 4.06 
    #> theta_3351 -0.53     -0.82 -0.25 1.00  306.69 0.00 
    #> theta_3377  0.05     -0.06  0.38 0.33    0.50 1.99 
    #> theta_3427 -0.11     -0.47  0.03 0.47    0.89 1.13 
    #> theta_3498  0.91      0.66  1.16 1.00     Inf 0.00 
    #> theta_3499 -0.49     -0.75 -0.24 1.00  209.53 0.00 
    #> theta_3533  0.12      0.00  0.42 0.54    1.16 0.86 
    #> theta_3610  0.28      0.00  0.55 0.89    7.79 0.13 
    #> theta_3657  0.30      0.00  0.55 0.93   13.29 0.08 
    #> theta_3688  0.33      0.00  0.59 0.94   14.94 0.07 
    #> theta_3705  0.74      0.51  0.97 1.00     Inf 0.00 
    #> theta_3716  0.03     -0.10  0.31 0.26    0.34 2.91 
    #> theta_3838 -0.50     -0.75 -0.23 1.00  443.44 0.00 
    #> theta_3881 -0.01     -0.21  0.10 0.22    0.27 3.65 
    #> theta_3967  0.11     -0.01  0.44 0.49    0.96 1.05 
    #> theta_3992 -0.17     -0.47  0.00 0.66    1.96 0.51 
    #> theta_3999  0.73      0.48  0.97 1.00     Inf 0.00 
    #> theta_4042  0.27      0.00  0.64 0.76    3.21 0.31 
    #> theta_4173  0.41      0.00  0.70 0.96   27.17 0.04 
    #> theta_4223 -0.07     -0.42  0.03 0.38    0.62 1.60 
    #> theta_4253 -0.25     -0.55  0.00 0.81    4.28 0.23 
    #> theta_4292  0.48      0.24  0.71 1.00 1999.00 0.00 
    #> theta_4325  0.79      0.48  1.11 1.00 3999.00 0.00 
    #> theta_4350 -0.66     -0.90 -0.41 1.00     Inf 0.00 
    #> theta_4383  0.16      0.00  0.46 0.67    2.00 0.50 
    #> theta_4410 -0.62     -0.90 -0.34 1.00     Inf 0.00 
    #> theta_4420 -0.46     -0.79  0.00 0.96   26.59 0.04 
    #> theta_4458 -0.27     -0.66  0.00 0.75    3.04 0.33 
    #> theta_4511 -1.18     -1.50 -0.88 1.00     Inf 0.00 
    #> theta_4523 -0.52     -0.79 -0.26 1.00  999.00 0.00 
    #> theta_4530  0.03     -0.08  0.29 0.27    0.37 2.71 
    #> theta_4642 -0.14     -0.54  0.02 0.53    1.11 0.90 
    #> theta_4868 -0.65     -0.91 -0.39 1.00     Inf 0.00 
    #> theta_4931  0.10      0.00  0.40 0.49    0.95 1.06 
    #> theta_5192 -0.53     -0.75 -0.30 1.00     Inf 0.00 
    #> theta_5404  0.04     -0.06  0.32 0.31    0.45 2.24 
    #> theta_5619  0.00     -0.19  0.22 0.23    0.29 3.40 
    #> theta_5640 -0.01     -0.22  0.09 0.22    0.28 3.61 
    #> theta_5650 -0.06     -0.42  0.08 0.35    0.54 1.85 
    #> theta_5667 -1.00     -1.26 -0.74 1.00     Inf 0.00 
    #> theta_5720 -0.56     -0.79 -0.34 1.00     Inf 0.00 
    #> theta_5761  0.13      0.00  0.43 0.56    1.26 0.80 
    #> theta_5762  0.01     -0.11  0.19 0.19    0.23 4.31 
    #> theta_5783 -0.88     -1.15 -0.61 1.00     Inf 0.00 
    #> theta_5815 -0.54     -0.80 -0.27 1.00  249.00 0.00 
    #> theta_5819 -0.06     -0.34  0.01 0.34    0.52 1.91 
    #> theta_5838  0.01     -0.07  0.20 0.19    0.24 4.21 
    #> theta_5937 -0.36     -0.64  0.00 0.94   15.46 0.06 
    #> theta_6074 -0.35     -0.62  0.00 0.94   16.70 0.06 
    #> theta_6089 -0.75     -1.01 -0.50 1.00     Inf 0.00 
    #> theta_6144 -1.18     -1.46 -0.89 1.00     Inf 0.00 
    #> theta_6170 -0.06     -0.39  0.05 0.35    0.53 1.87 
    #> theta_6291 -0.35     -0.64  0.00 0.94   14.63 0.07 
    #> theta_6366 -0.51     -0.75 -0.27 1.00     Inf 0.00 
    #> theta_6397 -0.03     -0.27  0.05 0.26    0.35 2.88 
    #> theta_6415 -0.20     -0.49  0.00 0.74    2.81 0.36 
    #> theta_6443 -0.24     -0.71  0.00 0.66    1.93 0.52 
    #> theta_6464  0.00     -0.16  0.19 0.22    0.28 3.62 
    #> theta_6469  0.04     -0.05  0.34 0.31    0.45 2.24 
    #> theta_6484 -0.22     -0.53  0.00 0.76    3.10 0.32 
    #> theta_6578  0.05     -0.03  0.36 0.32    0.47 2.12 
    #> theta_6600 -0.98     -1.23 -0.72 1.00     Inf 0.00 
    #> theta_6808  0.01     -0.12  0.20 0.21    0.27 3.68 
    #> theta_6816 -0.01     -0.24  0.16 0.24    0.31 3.18 
    #> theta_6897  0.01     -0.12  0.22 0.23    0.29 3.42 
    #> theta_6990  0.01     -0.11  0.25 0.23    0.30 3.36 
    #> theta_7011 -0.01     -0.19  0.11 0.19    0.24 4.18 
    #> theta_7101 -0.75     -1.01 -0.50 1.00     Inf 0.00 
    #> theta_7172 -0.02     -0.25  0.10 0.23    0.31 3.26 
    #> theta_7232  0.01     -0.16  0.27 0.25    0.34 2.98 
    #> theta_7276 -0.37     -0.69  0.00 0.91    9.87 0.10 
    #> theta_7332 -0.46     -0.72 -0.19 0.99  110.11 0.01 
    #> theta_7341 -0.76     -1.11 -0.41 1.00     Inf 0.00 
    #> theta_7342 -0.01     -0.16  0.10 0.18    0.22 4.48 
    #> theta_7345  0.27      0.00  0.53 0.87    6.52 0.15 
    #> theta_7364 -0.05     -0.35  0.03 0.34    0.51 1.97 
    #> theta_7635 -0.07     -0.37  0.03 0.39    0.64 1.56 
    #> theta_7688  0.00     -0.14  0.15 0.19    0.23 4.39 
    #> theta_7697  0.17      0.00  0.47 0.68    2.13 0.47 
    #> theta_7734  0.10     -0.01  0.44 0.46    0.84 1.19 
    #> theta_7890 -0.34     -0.61  0.00 0.94   16.70 0.06 
    #> theta_7919 -0.15     -0.55  0.00 0.53    1.13 0.88 
    #> theta_8009 -0.79     -1.11 -0.47 1.00     Inf 0.00 
    #> theta_8150 -0.68     -0.95 -0.41 1.00     Inf 0.00 
    #> theta_8165  0.02     -0.06  0.26 0.25    0.34 2.98 
    #> theta_8175  0.47      0.00  0.80 0.96   23.39 0.04 
    #> theta_8188  0.12      0.00  0.48 0.48    0.94 1.06 
    #> theta_8193 -0.34     -0.65  0.00 0.90    9.10 0.11 
    #> theta_8202  0.06     -0.07  0.42 0.36    0.57 1.77 
    #> theta_8357 -0.18     -0.54  0.00 0.63    1.72 0.58 
    #> theta_8367 -0.40     -0.65  0.00 0.97   38.60 0.03 
    #> theta_8477 -0.41     -0.78  0.00 0.91   10.14 0.10 
    #> theta_8531 -0.09     -0.40  0.00 0.46    0.86 1.17 
    #> theta_8627  0.02     -0.05  0.24 0.25    0.32 3.08 
    #> theta_8628 -0.03     -0.31  0.11 0.27    0.38 2.65 
    #> theta_8707  0.06     -0.01  0.35 0.35    0.53 1.89 
    #> theta_8775  0.45      0.19  0.69 1.00  265.67 0.00 
    #> theta_8800 -0.06     -0.36  0.04 0.35    0.54 1.87 
    #> theta_8854 -0.48     -0.76 -0.21 1.00  199.00 0.01 
    #> theta_8857  0.02     -0.12  0.29 0.25    0.33 2.99 
    #> theta_8874  0.10     -0.01  0.43 0.46    0.85 1.18 
    #> theta_8946 -0.63     -0.87 -0.39 1.00     Inf 0.00 
    #> theta_8983 -0.37     -0.62  0.00 0.97   36.04 0.03 
    #> theta_9021 -0.02     -0.24  0.08 0.23    0.29 3.42 
    #> theta_9104 -0.70     -0.97 -0.43 1.00     Inf 0.00 
    #> theta_9158 -0.45     -0.70 -0.19 0.99  147.15 0.01 
    #> theta_9198  0.04     -0.13  0.41 0.31    0.45 2.24 
    #> theta_9225  0.45      0.18  0.71 0.99  116.65 0.01 
    #> theta_9292  0.52      0.28  0.75 1.00  999.00 0.00 
    #> theta_9340 -0.05     -0.34  0.05 0.32    0.47 2.15 
    #> theta_9347  0.13      0.00  0.47 0.55    1.22 0.82 
    #> theta_9359  0.07      0.00  0.36 0.41    0.69 1.45 
    #> theta_9397  0.06     -0.06  0.44 0.34    0.51 1.97 
    #> theta_9508  0.01     -0.12  0.24 0.23    0.30 3.31 
    #> theta_9550  0.02     -0.05  0.24 0.22    0.27 3.65 
    #> theta_9586  0.03     -0.12  0.32 0.27    0.36 2.74

    caterpillar_plot(alpha, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-4-1.png" width="100%" />

    pip_plot(alpha, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-5-1.png" width="100%" />

Beta model
----------

    beta <- ivd_beta(y = d$y, X = d$ses, unit = d$school)
    posterior_summary(beta, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_beta(y = d$y, X = d$ses, unit = d$school)
    #> 
    #>       Post_mean q05   q95 
    #> alpha -0.01     -0.06 0.03
    #> beta   0.35      0.32 0.38
    #> sigma  0.88      0.87 0.90
    #> tau1   0.32      0.29 0.36
    #> tau2   0.11      0.02 0.18
    #> rho   -0.09     -0.71 0.48

    ranef_summary(beta, digits = 2)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_beta(y = d$y, X = d$ses, unit = d$school)
    #> 
    #>             Post_mean q05   q95   PIP  BF_10 BF_01
    #> theta1_1224 -0.77     -1.09 -0.45   NA   NA    NA 
    #> theta1_1288 -0.16     -0.40  0.08   NA   NA    NA 
    #> theta1_1296  0.27      0.07  0.47   NA   NA    NA 
    #> theta1_1308  0.15     -0.04  0.35   NA   NA    NA 
    #> theta1_1317 -0.19     -0.39  0.02   NA   NA    NA 
    #> theta1_1358  0.00     -0.21  0.20   NA   NA    NA 
    #> theta1_1374  0.09     -0.10  0.28   NA   NA    NA 
    #> theta1_1433 -0.09     -0.29  0.11   NA   NA    NA 
    #> theta1_1436  0.08     -0.15  0.30   NA   NA    NA 
    #> theta1_1461  0.20     -0.01  0.40   NA   NA    NA 
    #> theta1_1462  0.23      0.04  0.42   NA   NA    NA 
    #> theta1_1477 -0.08     -0.36  0.20   NA   NA    NA 
    #> theta1_1499 -0.15     -0.41  0.11   NA   NA    NA 
    #> theta1_1637 -0.07     -0.30  0.17   NA   NA    NA 
    #> theta1_1906  0.03     -0.20  0.26   NA   NA    NA 
    #> theta1_1909  0.17     -0.06  0.40   NA   NA    NA 
    #> theta1_1942  0.10     -0.09  0.28   NA   NA    NA 
    #> theta1_1946  0.31      0.14  0.50   NA   NA    NA 
    #> theta1_2030  0.12     -0.06  0.30   NA   NA    NA 
    #> theta1_2208  0.39      0.20  0.59   NA   NA    NA 
    #> theta1_2277  0.24      0.05  0.44   NA   NA    NA 
    #> theta1_2305  0.22      0.04  0.40   NA   NA    NA 
    #> theta1_2336  0.32      0.09  0.55   NA   NA    NA 
    #> theta1_2458 -0.06     -0.27  0.14   NA   NA    NA 
    #> theta1_2467  0.16     -0.02  0.33   NA   NA    NA 
    #> theta1_2526 -0.18     -0.44  0.07   NA   NA    NA 
    #> theta1_2626  0.37      0.09  0.64   NA   NA    NA 
    #> theta1_2629 -0.12     -0.32  0.08   NA   NA    NA 
    #> theta1_2639  0.09     -0.09  0.27   NA   NA    NA 
    #> theta1_2651  0.25     -0.03  0.53   NA   NA    NA 
    #> theta1_2655  0.64      0.39  0.88   NA   NA    NA 
    #> theta1_2658  0.51      0.30  0.73   NA   NA    NA 
    #> theta1_2755  0.25      0.00  0.51   NA   NA    NA 
    #> theta1_2768 -0.43     -0.68 -0.18   NA   NA    NA 
    #> theta1_2771 -0.41     -0.65 -0.17   NA   NA    NA 
    #> theta1_2818  0.44      0.20  0.70   NA   NA    NA 
    #> theta1_2917  0.03     -0.19  0.25   NA   NA    NA 
    #> theta1_2990  0.35      0.14  0.56   NA   NA    NA 
    #> theta1_2995  0.48      0.28  0.67   NA   NA    NA 
    #> theta1_3013  0.11     -0.11  0.33   NA   NA    NA 
    #> theta1_3020  0.32      0.12  0.53   NA   NA    NA 
    #> theta1_3039  0.00     -0.19  0.20   NA   NA    NA 
    #> theta1_3088  0.53      0.33  0.74   NA   NA    NA 
    #> theta1_3152  0.15     -0.03  0.34   NA   NA    NA 
    #> theta1_3332  0.06     -0.13  0.26   NA   NA    NA 
    #> theta1_3351 -0.29     -0.51 -0.06   NA   NA    NA 
    #> theta1_3377  0.02     -0.21  0.25   NA   NA    NA 
    #> theta1_3427 -0.24     -0.46 -0.03   NA   NA    NA 
    #> theta1_3498  0.85      0.65  1.05   NA   NA    NA 
    #> theta1_3499 -0.18     -0.38  0.03   NA   NA    NA 
    #> theta1_3533  0.21      0.03  0.40   NA   NA    NA 
    #> theta1_3610  0.11     -0.09  0.32   NA   NA    NA 
    #> theta1_3657  0.20      0.02  0.38   NA   NA    NA 
    #> theta1_3688  0.30      0.11  0.48   NA   NA    NA 
    #> theta1_3705  0.51      0.31  0.71   NA   NA    NA 
    #> theta1_3716  0.14     -0.09  0.37   NA   NA    NA 
    #> theta1_3838 -0.30     -0.50 -0.10   NA   NA    NA 
    #> theta1_3881 -0.02     -0.22  0.17   NA   NA    NA 
    #> theta1_3967  0.16     -0.04  0.36   NA   NA    NA 
    #> theta1_3992 -0.18     -0.36  0.00   NA   NA    NA 
    #> theta1_3999  0.68      0.50  0.87   NA   NA    NA 
    #> theta1_4042  0.29      0.05  0.53   NA   NA    NA 
    #> theta1_4173  0.49      0.29  0.71   NA   NA    NA 
    #> theta1_4223 -0.14     -0.37  0.09   NA   NA    NA 
    #> theta1_4253 -0.25     -0.45 -0.06   NA   NA    NA 
    #> theta1_4292  0.54      0.36  0.72   NA   NA    NA 
    #> theta1_4325  0.61      0.36  0.85   NA   NA    NA 
    #> theta1_4350 -0.40     -0.61 -0.20   NA   NA    NA 
    #> theta1_4383  0.10     -0.09  0.28   NA   NA    NA 
    #> theta1_4410 -0.37     -0.59 -0.16   NA   NA    NA 
    #> theta1_4420 -0.28     -0.52 -0.03   NA   NA    NA 
    #> theta1_4458 -0.24     -0.48  0.00   NA   NA    NA 
    #> theta1_4511 -0.76     -1.01 -0.52   NA   NA    NA 
    #> theta1_4523 -0.39     -0.60 -0.18   NA   NA    NA 
    #> theta1_4530  0.12     -0.09  0.33   NA   NA    NA 
    #> theta1_4642 -0.06     -0.31  0.19   NA   NA    NA 
    #> theta1_4868 -0.52     -0.73 -0.32   NA   NA    NA 
    #> theta1_4931  0.09     -0.11  0.29   NA   NA    NA 
    #> theta1_5192 -0.29     -0.53 -0.06   NA   NA    NA 
    #> theta1_5404  0.03     -0.17  0.24   NA   NA    NA 
    #> theta1_5619  0.01     -0.23  0.25   NA   NA    NA 
    #> theta1_5640  0.01     -0.18  0.20   NA   NA    NA 
    #> theta1_5650 -0.09     -0.34  0.16   NA   NA    NA 
    #> theta1_5667 -0.54     -0.76 -0.30   NA   NA    NA 
    #> theta1_5720 -0.29     -0.47 -0.11   NA   NA    NA 
    #> theta1_5761  0.07     -0.13  0.27   NA   NA    NA 
    #> theta1_5762  0.13     -0.06  0.31   NA   NA    NA 
    #> theta1_5783 -0.47     -0.71 -0.24   NA   NA    NA 
    #> theta1_5815 -0.28     -0.51 -0.07   NA   NA    NA 
    #> theta1_5819  0.07     -0.12  0.26   NA   NA    NA 
    #> theta1_5838  0.05     -0.14  0.23   NA   NA    NA 
    #> theta1_5937 -0.35     -0.56 -0.15   NA   NA    NA 
    #> theta1_6074 -0.25     -0.44 -0.05   NA   NA    NA 
    #> theta1_6089 -0.51     -0.71 -0.29   NA   NA    NA 
    #> theta1_6144 -0.65     -0.89 -0.41   NA   NA    NA 
    #> theta1_6170 -0.14     -0.38  0.09   NA   NA    NA 
    #> theta1_6291 -0.33     -0.53 -0.13   NA   NA    NA 
    #> theta1_6366 -0.32     -0.52 -0.13   NA   NA    NA 
    #> theta1_6397  0.20     -0.01  0.42   NA   NA    NA 
    #> theta1_6415 -0.06     -0.26  0.13   NA   NA    NA 
    #> theta1_6443 -0.10     -0.39  0.19   NA   NA    NA 
    #> theta1_6464 -0.05     -0.27  0.18   NA   NA    NA 
    #> theta1_6469  0.21      0.00  0.42   NA   NA    NA 
    #> theta1_6484 -0.12     -0.32  0.07   NA   NA    NA 
    #> theta1_6578  0.20     -0.01  0.40   NA   NA    NA 
    #> theta1_6600 -0.71     -0.90 -0.51   NA   NA    NA 
    #> theta1_6808 -0.04     -0.24  0.17   NA   NA    NA 
    #> theta1_6816 -0.03     -0.27  0.20   NA   NA    NA 
    #> theta1_6897  0.07     -0.15  0.28   NA   NA    NA 
    #> theta1_6990  0.15     -0.08  0.38   NA   NA    NA 
    #> theta1_7011 -0.02     -0.22  0.18   NA   NA    NA 
    #> theta1_7101 -0.47     -0.67 -0.28   NA   NA    NA 
    #> theta1_7172  0.04     -0.17  0.27   NA   NA    NA 
    #> theta1_7232  0.06     -0.19  0.32   NA   NA    NA 
    #> theta1_7276 -0.15     -0.38  0.08   NA   NA    NA 
    #> theta1_7332 -0.23     -0.43 -0.03   NA   NA    NA 
    #> theta1_7341 -0.41     -0.67 -0.15   NA   NA    NA 
    #> theta1_7342  0.15     -0.04  0.34   NA   NA    NA 
    #> theta1_7345  0.19      0.02  0.38   NA   NA    NA 
    #> theta1_7364 -0.01     -0.20  0.19   NA   NA    NA 
    #> theta1_7635 -0.04     -0.23  0.15   NA   NA    NA 
    #> theta1_7688 -0.04     -0.23  0.17   NA   NA    NA 
    #> theta1_7697  0.32      0.14  0.51   NA   NA    NA 
    #> theta1_7734  0.27      0.07  0.48   NA   NA    NA 
    #> theta1_7890 -0.10     -0.32  0.11   NA   NA    NA 
    #> theta1_7919 -0.20     -0.44  0.04   NA   NA    NA 
    #> theta1_8009 -0.45     -0.70 -0.19   NA   NA    NA 
    #> theta1_8150 -0.48     -0.69 -0.28   NA   NA    NA 
    #> theta1_8165  0.04     -0.15  0.23   NA   NA    NA 
    #> theta1_8175  0.30      0.05  0.56   NA   NA    NA 
    #> theta1_8188  0.12     -0.10  0.35   NA   NA    NA 
    #> theta1_8193 -0.12     -0.34  0.11   NA   NA    NA 
    #> theta1_8202  0.14     -0.10  0.38   NA   NA    NA 
    #> theta1_8357 -0.21     -0.43  0.00   NA   NA    NA 
    #> theta1_8367 -0.21     -0.41 -0.02   NA   NA    NA 
    #> theta1_8477 -0.33     -0.57 -0.08   NA   NA    NA 
    #> theta1_8531 -0.10     -0.29  0.09   NA   NA    NA 
    #> theta1_8627  0.01     -0.18  0.19   NA   NA    NA 
    #> theta1_8628 -0.14     -0.37  0.09   NA   NA    NA 
    #> theta1_8707  0.20      0.00  0.39   NA   NA    NA 
    #> theta1_8775  0.29      0.09  0.51   NA   NA    NA 
    #> theta1_8800 -0.12     -0.34  0.09   NA   NA    NA 
    #> theta1_8854 -0.30     -0.50 -0.10   NA   NA    NA 
    #> theta1_8857  0.08     -0.15  0.31   NA   NA    NA 
    #> theta1_8874  0.13     -0.09  0.34   NA   NA    NA 
    #> theta1_8946 -0.38     -0.57 -0.19   NA   NA    NA 
    #> theta1_8983 -0.19     -0.37  0.00   NA   NA    NA 
    #> theta1_9021  0.02     -0.18  0.21   NA   NA    NA 
    #> theta1_9104 -0.35     -0.57 -0.13   NA   NA    NA 
    #> theta1_9158 -0.31     -0.51 -0.12   NA   NA    NA 
    #> theta1_9198  0.24     -0.03  0.52   NA   NA    NA 
    #> theta1_9225  0.39      0.19  0.59   NA   NA    NA 
    #> theta1_9292  0.31      0.10  0.51   NA   NA    NA 
    #> theta1_9340 -0.16     -0.37  0.04   NA   NA    NA 
    #> theta1_9347  0.19     -0.01  0.40   NA   NA    NA 
    #> theta1_9359  0.10     -0.08  0.28   NA   NA    NA 
    #> theta1_9397  0.23     -0.03  0.48   NA   NA    NA 
    #> theta1_9508 -0.02     -0.23  0.20   NA   NA    NA 
    #> theta1_9550  0.22      0.03  0.41   NA   NA    NA 
    #> theta1_9586  0.21     -0.03  0.45   NA   NA    NA 
    #> theta2_1224 -0.01     -0.20  0.13 0.49 0.94  1.06 
    #> theta2_1288  0.04     -0.06  0.22 0.54 1.19  0.84 
    #> theta2_1296  0.00     -0.12  0.12 0.47 0.88  1.13 
    #> theta2_1308 -0.03     -0.20  0.06 0.51 1.05  0.95 
    #> theta2_1317  0.03     -0.03  0.19 0.50 1.01  0.99 
    #> theta2_1358  0.01     -0.08  0.16 0.47 0.90  1.11 
    #> theta2_1374  0.01     -0.08  0.12 0.44 0.79  1.27 
    #> theta2_1433  0.02     -0.07  0.15 0.48 0.92  1.09 
    #> theta2_1436 -0.03     -0.20  0.06 0.53 1.13  0.89 
    #> theta2_1461  0.02     -0.06  0.18 0.48 0.93  1.07 
    #> theta2_1462  0.00     -0.11  0.12 0.47 0.88  1.13 
    #> theta2_1477  0.08     -0.02  0.29 0.63 1.73  0.58 
    #> theta2_1499  0.04     -0.07  0.22 0.54 1.15  0.87 
    #> theta2_1637 -0.01     -0.14  0.09 0.47 0.89  1.12 
    #> theta2_1906  0.03     -0.06  0.19 0.51 1.05  0.96 
    #> theta2_1909  0.01     -0.10  0.14 0.47 0.89  1.12 
    #> theta2_1942  0.01     -0.09  0.14 0.47 0.88  1.14 
    #> theta2_1946  0.01     -0.09  0.13 0.46 0.85  1.17 
    #> theta2_2030  0.02     -0.07  0.17 0.48 0.91  1.10 
    #> theta2_2208 -0.04     -0.22  0.04 0.53 1.11  0.90 
    #> theta2_2277 -0.06     -0.26  0.03 0.57 1.31  0.76 
    #> theta2_2305  0.01     -0.10  0.13 0.46 0.86  1.16 
    #> theta2_2336 -0.01     -0.15  0.10 0.49 0.96  1.04 
    #> theta2_2458 -0.10     -0.32  0.01 0.71 2.48  0.40 
    #> theta2_2467 -0.02     -0.16  0.05 0.49 0.96  1.04 
    #> theta2_2526  0.02     -0.07  0.15 0.48 0.92  1.08 
    #> theta2_2626  0.01     -0.11  0.16 0.47 0.90  1.11 
    #> theta2_2629 -0.01     -0.13  0.10 0.46 0.85  1.18 
    #> theta2_2639  0.01     -0.08  0.11 0.44 0.79  1.27 
    #> theta2_2651 -0.01     -0.15  0.13 0.49 0.97  1.03 
    #> theta2_2655  0.01     -0.12  0.16 0.47 0.88  1.14 
    #> theta2_2658  0.00     -0.13  0.13 0.45 0.83  1.20 
    #> theta2_2755  0.08     -0.02  0.32 0.63 1.69  0.59 
    #> theta2_2768  0.03     -0.07  0.19 0.49 0.94  1.06 
    #> theta2_2771  0.02     -0.07  0.16 0.47 0.87  1.15 
    #> theta2_2818 -0.01     -0.16  0.12 0.48 0.92  1.09 
    #> theta2_2917  0.02     -0.07  0.17 0.48 0.92  1.09 
    #> theta2_2990  0.00     -0.12  0.10 0.45 0.83  1.21 
    #> theta2_2995 -0.04     -0.23  0.05 0.53 1.13  0.89 
    #> theta2_3013  0.02     -0.09  0.18 0.50 0.99  1.01 
    #> theta2_3020 -0.03     -0.19  0.06 0.48 0.93  1.07 
    #> theta2_3039  0.02     -0.06  0.18 0.49 0.96  1.05 
    #> theta2_3088 -0.01     -0.14  0.10 0.46 0.86  1.17 
    #> theta2_3152 -0.01     -0.14  0.08 0.47 0.89  1.12 
    #> theta2_3332  0.01     -0.08  0.12 0.45 0.83  1.21 
    #> theta2_3351  0.00     -0.12  0.10 0.45 0.83  1.20 
    #> theta2_3377  0.00     -0.12  0.11 0.47 0.89  1.12 
    #> theta2_3427  0.00     -0.11  0.11 0.46 0.87  1.15 
    #> theta2_3498 -0.07     -0.30  0.03 0.59 1.41  0.71 
    #> theta2_3499  0.04     -0.04  0.20 0.53 1.13  0.88 
    #> theta2_3533  0.02     -0.07  0.16 0.47 0.90  1.11 
    #> theta2_3610 -0.01     -0.14  0.08 0.47 0.88  1.14 
    #> theta2_3657  0.07     -0.03  0.29 0.63 1.68  0.59 
    #> theta2_3688 -0.02     -0.15  0.08 0.47 0.90  1.11 
    #> theta2_3705  0.00     -0.12  0.11 0.45 0.81  1.23 
    #> theta2_3716  0.03     -0.07  0.22 0.53 1.14  0.88 
    #> theta2_3838 -0.02     -0.17  0.08 0.48 0.92  1.09 
    #> theta2_3881  0.03     -0.05  0.19 0.52 1.07  0.93 
    #> theta2_3967  0.00     -0.11  0.12 0.47 0.89  1.13 
    #> theta2_3992  0.06     -0.02  0.23 0.60 1.48  0.68 
    #> theta2_3999 -0.04     -0.23  0.06 0.52 1.07  0.93 
    #> theta2_4042  0.01     -0.11  0.15 0.49 0.95  1.05 
    #> theta2_4173 -0.01     -0.14  0.11 0.47 0.88  1.14 
    #> theta2_4223  0.02     -0.08  0.17 0.50 1.01  0.99 
    #> theta2_4253 -0.01     -0.13  0.09 0.47 0.87  1.15 
    #> theta2_4292 -0.03     -0.20  0.06 0.50 1.00  1.00 
    #> theta2_4325  0.01     -0.12  0.18 0.48 0.92  1.09 
    #> theta2_4350 -0.04     -0.23  0.07 0.52 1.07  0.94 
    #> theta2_4383 -0.01     -0.14  0.08 0.48 0.92  1.09 
    #> theta2_4410  0.02     -0.08  0.16 0.48 0.92  1.08 
    #> theta2_4420 -0.05     -0.25  0.05 0.54 1.16  0.86 
    #> theta2_4458 -0.01     -0.14  0.10 0.48 0.93  1.08 
    #> theta2_4511  0.02     -0.07  0.19 0.48 0.92  1.08 
    #> theta2_4523  0.00     -0.11  0.11 0.46 0.85  1.18 
    #> theta2_4530  0.00     -0.11  0.12 0.46 0.87  1.15 
    #> theta2_4642  0.01     -0.10  0.15 0.48 0.91  1.10 
    #> theta2_4868  0.00     -0.11  0.13 0.46 0.84  1.19 
    #> theta2_4931 -0.02     -0.16  0.06 0.50 0.99  1.02 
    #> theta2_5192 -0.13     -0.39  0.00 0.75 2.94  0.34 
    #> theta2_5404 -0.01     -0.15  0.10 0.48 0.94  1.07 
    #> theta2_5619  0.01     -0.09  0.14 0.48 0.91  1.10 
    #> theta2_5640  0.02     -0.08  0.16 0.48 0.92  1.09 
    #> theta2_5650 -0.02     -0.16  0.08 0.48 0.93  1.08 
    #> theta2_5667  0.01     -0.10  0.13 0.46 0.84  1.19 
    #> theta2_5720  0.00     -0.12  0.10 0.46 0.85  1.17 
    #> theta2_5761  0.00     -0.11  0.11 0.48 0.92  1.09 
    #> theta2_5762 -0.04     -0.23  0.04 0.54 1.20  0.83 
    #> theta2_5783 -0.02     -0.19  0.08 0.48 0.91  1.10 
    #> theta2_5815 -0.06     -0.27  0.04 0.58 1.35  0.74 
    #> theta2_5819  0.00     -0.11  0.11 0.47 0.89  1.13 
    #> theta2_5838  0.01     -0.10  0.12 0.47 0.88  1.14 
    #> theta2_5937 -0.02     -0.18  0.07 0.49 0.95  1.05 
    #> theta2_6074 -0.03     -0.21  0.07 0.53 1.12  0.89 
    #> theta2_6089 -0.01     -0.15  0.10 0.46 0.85  1.18 
    #> theta2_6144  0.01     -0.10  0.15 0.45 0.81  1.23 
    #> theta2_6170  0.03     -0.06  0.19 0.52 1.08  0.92 
    #> theta2_6291  0.00     -0.11  0.13 0.47 0.89  1.12 
    #> theta2_6366 -0.07     -0.28  0.03 0.59 1.45  0.69 
    #> theta2_6397  0.04     -0.04  0.23 0.54 1.18  0.85 
    #> theta2_6415 -0.02     -0.16  0.07 0.49 0.96  1.04 
    #> theta2_6443  0.00     -0.14  0.11 0.49 0.95  1.06 
    #> theta2_6464 -0.02     -0.16  0.08 0.48 0.94  1.07 
    #> theta2_6469 -0.03     -0.19  0.07 0.51 1.04  0.96 
    #> theta2_6484 -0.01     -0.15  0.08 0.48 0.91  1.10 
    #> theta2_6578 -0.04     -0.22  0.04 0.53 1.12  0.89 
    #> theta2_6600 -0.02     -0.17  0.07 0.43 0.77  1.30 
    #> theta2_6808  0.00     -0.11  0.12 0.46 0.86  1.17 
    #> theta2_6816  0.03     -0.07  0.19 0.51 1.04  0.96 
    #> theta2_6897  0.00     -0.11  0.12 0.45 0.83  1.20 
    #> theta2_6990  0.01     -0.09  0.16 0.47 0.90  1.12 
    #> theta2_7011  0.02     -0.06  0.16 0.49 0.95  1.05 
    #> theta2_7101  0.04     -0.04  0.22 0.54 1.18  0.85 
    #> theta2_7172  0.02     -0.06  0.18 0.50 1.02  0.98 
    #> theta2_7232  0.01     -0.10  0.15 0.50 1.00  1.00 
    #> theta2_7276  0.02     -0.07  0.18 0.50 1.00  1.01 
    #> theta2_7332  0.01     -0.09  0.13 0.46 0.85  1.18 
    #> theta2_7341  0.02     -0.08  0.18 0.49 0.96  1.04 
    #> theta2_7342 -0.08     -0.29  0.01 0.64 1.76  0.57 
    #> theta2_7345 -0.02     -0.18  0.07 0.48 0.94  1.06 
    #> theta2_7364  0.02     -0.08  0.16 0.48 0.92  1.08 
    #> theta2_7635  0.02     -0.07  0.17 0.48 0.93  1.07 
    #> theta2_7688 -0.01     -0.15  0.09 0.51 1.05  0.96 
    #> theta2_7697 -0.06     -0.26  0.02 0.61 1.55  0.65 
    #> theta2_7734  0.00     -0.12  0.11 0.47 0.88  1.14 
    #> theta2_7890 -0.06     -0.26  0.03 0.57 1.32  0.76 
    #> theta2_7919  0.03     -0.07  0.19 0.50 0.99  1.01 
    #> theta2_8009  0.00     -0.11  0.13 0.45 0.83  1.21 
    #> theta2_8150 -0.01     -0.16  0.09 0.45 0.82  1.21 
    #> theta2_8165 -0.03     -0.19  0.05 0.51 1.04  0.96 
    #> theta2_8175  0.00     -0.14  0.11 0.47 0.88  1.13 
    #> theta2_8188  0.02     -0.09  0.17 0.50 1.00  1.00 
    #> theta2_8193  0.12      0.00  0.34 0.75 2.98  0.34 
    #> theta2_8202  0.01     -0.10  0.14 0.49 0.95  1.05 
    #> theta2_8357  0.04     -0.05  0.21 0.53 1.11  0.90 
    #> theta2_8367  0.01     -0.08  0.15 0.46 0.85  1.17 
    #> theta2_8477  0.02     -0.08  0.17 0.50 1.00  1.00 
    #> theta2_8531  0.06     -0.03  0.26 0.60 1.49  0.67 
    #> theta2_8627  0.02     -0.07  0.16 0.48 0.94  1.06 
    #> theta2_8628 -0.02     -0.16  0.08 0.48 0.93  1.08 
    #> theta2_8707  0.00     -0.10  0.11 0.44 0.79  1.27 
    #> theta2_8775 -0.04     -0.21  0.06 0.53 1.15  0.87 
    #> theta2_8800  0.00     -0.13  0.12 0.49 0.95  1.05 
    #> theta2_8854 -0.02     -0.15  0.07 0.46 0.86  1.16 
    #> theta2_8857 -0.01     -0.14  0.11 0.48 0.93  1.08 
    #> theta2_8874 -0.01     -0.13  0.10 0.48 0.94  1.07 
    #> theta2_8946  0.05     -0.03  0.22 0.56 1.26  0.79 
    #> theta2_8983 -0.01     -0.13  0.08 0.46 0.86  1.16 
    #> theta2_9021  0.04     -0.05  0.23 0.56 1.25  0.80 
    #> theta2_9104 -0.02     -0.14  0.06 0.45 0.81  1.24 
    #> theta2_9158 -0.01     -0.13  0.07 0.45 0.82  1.21 
    #> theta2_9198  0.03     -0.07  0.19 0.50 0.99  1.02 
    #> theta2_9225 -0.01     -0.14  0.09 0.46 0.84  1.19 
    #> theta2_9292  0.00     -0.13  0.12 0.46 0.84  1.19 
    #> theta2_9340 -0.02     -0.16  0.08 0.49 0.98  1.02 
    #> theta2_9347 -0.04     -0.23  0.05 0.55 1.21  0.83 
    #> theta2_9359 -0.01     -0.14  0.08 0.48 0.91  1.10 
    #> theta2_9397  0.00     -0.10  0.11 0.45 0.83  1.21 
    #> theta2_9508  0.01     -0.08  0.15 0.48 0.93  1.07 
    #> theta2_9550 -0.02     -0.17  0.07 0.50 1.00  1.00 
    #> theta2_9586  0.00     -0.11  0.13 0.47 0.89  1.12

    caterpillar_plot(beta, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-8-1.png" width="100%" />

    pip_plot(beta, legend = FALSE)

<img src="man/figures/README-unnamed-chunk-9-1.png" width="100%" />

Multivariate model
------------------

    mv_data <- gen_mv_data(5, 5)
    str(mv_data)
    #> 'data.frame':    25 obs. of  4 variables:
    #>  $ y1: num  3.244 2.912 0.461 2.115 2.354 ...
    #>  $ y2: num  1.69 1.54 3.23 3.71 2.02 ...
    #>  $ x : num  0 0 1 1 0 1 0 0 0 1 ...
    #>  $ id: Factor w/ 5 levels "1","2","3","4",..: 1 1 1 1 1 2 2 2 2 2 ...

    mv_model <- ivd_mv(Y = cbind(mv_data$y1, mv_data$y2),
                            X = mv_data$x,
                            unit = mv_data$id,
                            burnin = 100,
                            iter = 500,
                            chains = 4)

    posterior_summary(mv_model)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_mv(Y = cbind(mv_data$y1, mv_data$y2), X = mv_data$x, unit = mv_data$id, 
    #>     burnin = 100, iter = 500, chains = 4)
    #> 
    #>         Post_mean q05   q95  
    #> B_1_1    1.26     -0.20  2.68
    #> B_1_2    1.49     -1.11  4.05
    #> B_2_1    1.65      1.21  2.08
    #> B_2_2    3.68      1.68  5.27
    #> rb_1_2  -0.16     -0.99  0.99
    #> rb_1_3  -0.09     -0.98  0.97
    #> rb_1_4   0.14     -0.97  0.98
    #> rb_2_3  -0.12     -0.99  0.98
    #> rb_2_4   0.35     -0.98  0.99
    #> rb_3_4   0.14     -0.96  0.98
    #> rw       0.57      0.25  0.79
    #> sigma_1  3.39      2.43  4.71
    #> sigma_2  0.96      0.72  1.30
    #> Tau_1_1 10.74      0.35 40.50
    #> Tau_2_2 27.38      0.76 81.46
    #> Tau_3_3  7.16      0.26 28.84
    #> Tau_4_4  8.49      1.20 25.10

Priors
------

Priors can be passed on to either of the `ivd` functions through a named
list and using JAGS code, e.g.,

    # change prior for mean intercept
    priors <- list(alpha = "alpha ~ dt(0, 1, 3)",
                   # for each jth unit, change prior probability of inclusion
                   gamma = "gamma[j] ~ dbern(0.75)") 

    fit <- ivd_alpha(y = d$y, unit = d$school, priors = priors)
    ranef_summary(fit)
    #> Linear mixed model fit with SSranef
    #> Call: ivd_alpha(y = d$y, unit = d$school, priors = priors)
    #> 
    #>            Post_mean q05   q95   PIP  BF_10   BF_01
    #> theta_1224 -0.96     -1.33 -0.59 1.00     Inf 0.00 
    #> theta_1288 -0.16     -0.47  0.02 0.72    2.56 0.39 
    #> theta_1296  0.43      0.22  0.63 1.00  249.00 0.00 
    #> theta_1308  0.21      0.00  0.44 0.85    5.54 0.18 
    #> theta_1317 -0.23     -0.47  0.00 0.87    6.58 0.15 
    #> theta_1358 -0.01     -0.19  0.15 0.45    0.82 1.22 
    #> theta_1374  0.02     -0.10  0.20 0.46    0.86 1.16 
    #> theta_1433 -0.20     -0.43  0.00 0.83    5.00 0.20 
    #> theta_1436  0.01     -0.18  0.20 0.49    0.97 1.03 
    #> theta_1461  0.29      0.00  0.52 0.94   15.06 0.07 
    #> theta_1462  0.28      0.00  0.50 0.93   12.75 0.08 
    #> theta_1477 -0.23     -0.57  0.00 0.81    4.37 0.23 
    #> theta_1499 -0.11     -0.42  0.07 0.65    1.84 0.54 
    #> theta_1637 -0.09     -0.37  0.06 0.60    1.49 0.67 
    #> theta_1906 -0.07     -0.31  0.08 0.55    1.23 0.81 
    #> theta_1909  0.19      0.00  0.47 0.78    3.64 0.27 
    #> theta_1942  0.10     -0.01  0.33 0.63    1.71 0.58 
    #> theta_1946  0.34      0.14  0.53 0.99   75.92 0.01 
    #> theta_2030  0.02     -0.10  0.19 0.44    0.78 1.28 
    #> theta_2208  0.44      0.23  0.64 1.00 1999.00 0.00 
    #> theta_2277  0.31      0.00  0.52 0.95   19.10 0.05 
    #> theta_2305  0.34      0.13  0.55 0.98   49.63 0.02 
    #> theta_2336  0.33      0.00  0.60 0.93   13.65 0.07 
    #> theta_2458 -0.21     -0.42  0.00 0.87    6.52 0.15 
    #> theta_2467  0.14      0.00  0.36 0.76    3.12 0.32 
    #> theta_2526 -0.20     -0.52  0.00 0.76    3.25 0.31 
    #> theta_2626  0.50      0.14  0.81 0.97   37.46 0.03 
    #> theta_2629 -0.05     -0.28  0.07 0.52    1.08 0.92 
    #> theta_2639  0.00     -0.15  0.14 0.43    0.75 1.33 
    #> theta_2651  0.39      0.00  0.72 0.93   13.34 0.07 
    #> theta_2655  0.90      0.65  1.14 1.00     Inf 0.00 
    #> theta_2658  0.71      0.49  0.93 1.00     Inf 0.00 
    #> theta_2755  0.52      0.26  0.78 1.00  332.33 0.00 
    #> theta_2768 -0.75     -1.02 -0.47 1.00     Inf 0.00 
    #> theta_2771 -0.72     -0.97 -0.47 1.00     Inf 0.00 
    #> theta_2818  0.68      0.41  0.94 1.00  999.00 0.00 
    #> theta_2917  0.00     -0.18  0.19 0.47    0.90 1.12 
    #> theta_2990  0.49      0.27  0.71 1.00  999.00 0.00 
    #> theta_2995  0.57      0.37  0.77 1.00     Inf 0.00 
    #> theta_3013  0.04     -0.11  0.25 0.52    1.06 0.94 
    #> theta_3020  0.49      0.27  0.70 1.00  284.71 0.00 
    #> theta_3039 -0.09     -0.31  0.03 0.62    1.65 0.61 
    #> theta_3088  0.75      0.54  0.97 1.00     Inf 0.00 
    #> theta_3152  0.17      0.00  0.40 0.78    3.48 0.29 
    #> theta_3332  0.02     -0.11  0.20 0.45    0.83 1.21 
    #> theta_3351 -0.49     -0.73 -0.26 1.00  443.44 0.00 
    #> theta_3377  0.13     -0.02  0.40 0.68    2.17 0.46 
    #> theta_3427 -0.13     -0.39  0.02 0.68    2.08 0.48 
    #> theta_3498  0.93      0.71  1.14 1.00     Inf 0.00 
    #> theta_3499 -0.45     -0.66 -0.25 1.00  306.69 0.00 
    #> theta_3533  0.21      0.00  0.43 0.85    5.77 0.17 
    #> theta_3610  0.34      0.11  0.55 0.98   45.51 0.02 
    #> theta_3657  0.35      0.15  0.54 0.99  107.11 0.01 
    #> theta_3688  0.38      0.17  0.58 0.99  116.65 0.01 
    #> theta_3705  0.77      0.57  0.97 1.00     Inf 0.00 
    #> theta_3716  0.08     -0.08  0.35 0.59    1.43 0.70 
    #> theta_3838 -0.46     -0.68 -0.24 1.00  306.69 0.00 
    #> theta_3881 -0.01     -0.17  0.12 0.42    0.73 1.38 
    #> theta_3967  0.20      0.00  0.44 0.82    4.53 0.22 
    #> theta_3992 -0.17     -0.40  0.00 0.78    3.60 0.28 
    #> theta_3999  0.76      0.56  0.97 1.00     Inf 0.00 
    #> theta_4042  0.36      0.00  0.63 0.95   20.51 0.05 
    #> theta_4173  0.45      0.22  0.68 1.00  306.69 0.00 
    #> theta_4223 -0.10     -0.36  0.05 0.61    1.57 0.64 
    #> theta_4253 -0.24     -0.47  0.00 0.89    8.48 0.12 
    #> theta_4292  0.51      0.31  0.70 1.00     Inf 0.00 
    #> theta_4325  0.81      0.55  1.06 1.00     Inf 0.00 
    #> theta_4350 -0.61     -0.82 -0.40 1.00     Inf 0.00 
    #> theta_4383  0.25      0.00  0.47 0.92   10.94 0.09 
    #> theta_4410 -0.58     -0.81 -0.35 1.00     Inf 0.00 
    #> theta_4420 -0.43     -0.70 -0.14 0.98   42.48 0.02 
    #> theta_4458 -0.28     -0.58  0.00 0.86    6.34 0.16 
    #> theta_4511 -1.13     -1.39 -0.87 1.00     Inf 0.00 
    #> theta_4523 -0.48     -0.71 -0.25 1.00 1332.33 0.00 
    #> theta_4530  0.08     -0.05  0.33 0.57    1.35 0.74 
    #> theta_4642 -0.16     -0.46  0.02 0.72    2.55 0.39 
    #> theta_4868 -0.61     -0.83 -0.40 1.00     Inf 0.00 
    #> theta_4931  0.19      0.00  0.43 0.82    4.54 0.22 
    #> theta_5192 -0.49     -0.69 -0.29 1.00     Inf 0.00 
    #> theta_5404  0.11     -0.02  0.36 0.65    1.83 0.55 
    #> theta_5619  0.02     -0.18  0.25 0.53    1.11 0.90 
    #> theta_5640 -0.02     -0.18  0.12 0.44    0.77 1.30 
    #> theta_5650 -0.08     -0.36  0.09 0.58    1.36 0.74 
    #> theta_5667 -0.95     -1.17 -0.73 1.00     Inf 0.00 
    #> theta_5720 -0.52     -0.71 -0.33 1.00     Inf 0.00 
    #> theta_5761  0.22      0.00  0.44 0.86    6.39 0.16 
    #> theta_5762  0.04     -0.07  0.23 0.48    0.91 1.10 
    #> theta_5783 -0.84     -1.07 -0.61 1.00     Inf 0.00 
    #> theta_5815 -0.49     -0.71 -0.27 1.00  249.00 0.00 
    #> theta_5819 -0.07     -0.28  0.05 0.56    1.27 0.79 
    #> theta_5838  0.05     -0.06  0.25 0.51    1.03 0.97 
    #> theta_5937 -0.33     -0.56 -0.04 0.96   24.97 0.04 
    #> theta_6074 -0.32     -0.55  0.00 0.95   20.28 0.05 
    #> theta_6089 -0.71     -0.92 -0.49 1.00     Inf 0.00 
    #> theta_6144 -1.13     -1.38 -0.89 1.00     Inf 0.00 
    #> theta_6170 -0.08     -0.34  0.07 0.58    1.39 0.72 
    #> theta_6291 -0.33     -0.55 -0.04 0.96   24.48 0.04 
    #> theta_6366 -0.47     -0.67 -0.27 1.00 3999.00 0.00 
    #> theta_6397 -0.03     -0.22  0.09 0.48    0.92 1.08 
    #> theta_6415 -0.20     -0.42  0.00 0.83    4.80 0.21 
    #> theta_6443 -0.27     -0.63  0.00 0.83    4.97 0.20 
    #> theta_6464  0.03     -0.13  0.24 0.50    1.02 0.98 
    #> theta_6469  0.12     -0.02  0.38 0.68    2.11 0.47 
    #> theta_6484 -0.22     -0.45  0.00 0.88    7.18 0.14 
    #> theta_6578  0.13     -0.01  0.39 0.70    2.29 0.44 
    #> theta_6600 -0.94     -1.15 -0.73 1.00     Inf 0.00 
    #> theta_6808  0.04     -0.10  0.24 0.48    0.92 1.09 
    #> theta_6816 -0.01     -0.23  0.18 0.51    1.04 0.96 
    #> theta_6897  0.04     -0.10  0.26 0.51    1.02 0.98 
    #> theta_6990  0.05     -0.11  0.30 0.55    1.20 0.83 
    #> theta_7011  0.00     -0.17  0.16 0.46    0.85 1.18 
    #> theta_7101 -0.71     -0.92 -0.50 1.00     Inf 0.00 
    #> theta_7172 -0.02     -0.23  0.15 0.49    0.95 1.06 
    #> theta_7232  0.05     -0.14  0.32 0.57    1.30 0.77 
    #> theta_7276 -0.34     -0.61  0.00 0.94   16.94 0.06 
    #> theta_7332 -0.42     -0.64 -0.20 0.99  128.03 0.01 
    #> theta_7341 -0.71     -1.00 -0.42 1.00     Inf 0.00 
    #> theta_7342  0.00     -0.13  0.14 0.43    0.76 1.32 
    #> theta_7345  0.33      0.12  0.53 0.98   45.51 0.02 
    #> theta_7364 -0.07     -0.28  0.05 0.56    1.26 0.79 
    #> theta_7635 -0.08     -0.31  0.03 0.60    1.48 0.68 
    #> theta_7688  0.02     -0.12  0.20 0.45    0.81 1.23 
    #> theta_7697  0.26      0.00  0.48 0.91   10.66 0.09 
    #> theta_7734  0.19      0.00  0.45 0.79    3.78 0.26 
    #> theta_7890 -0.31     -0.52 -0.07 0.96   25.67 0.04 
    #> theta_7919 -0.17     -0.47  0.02 0.76    3.14 0.32 
    #> theta_8009 -0.74     -1.01 -0.47 1.00     Inf 0.00 
    #> theta_8150 -0.64     -0.87 -0.42 1.00     Inf 0.00 
    #> theta_8165  0.08     -0.03  0.30 0.59    1.42 0.70 
    #> theta_8175  0.50      0.23  0.78 0.99  124.00 0.01 
    #> theta_8188  0.22      0.00  0.49 0.82    4.63 0.22 
    #> theta_8193 -0.31     -0.56  0.00 0.93   14.27 0.07 
    #> theta_8202  0.14     -0.03  0.45 0.68    2.16 0.46 
    #> theta_8357 -0.19     -0.46  0.00 0.78    3.47 0.29 
    #> theta_8367 -0.37     -0.57 -0.14 0.98   55.34 0.02 
    #> theta_8477 -0.38     -0.67  0.00 0.95   18.61 0.05 
    #> theta_8531 -0.10     -0.32  0.01 0.64    1.76 0.57 
    #> theta_8627  0.08     -0.03  0.30 0.58    1.40 0.72 
    #> theta_8628 -0.04     -0.27  0.12 0.53    1.14 0.87 
    #> theta_8707  0.15      0.00  0.39 0.74    2.87 0.35 
    #> theta_8775  0.48      0.28  0.69 1.00     Inf 0.00 
    #> theta_8800 -0.07     -0.32  0.06 0.59    1.45 0.69 
    #> theta_8854 -0.44     -0.67 -0.21 0.99  147.15 0.01 
    #> theta_8857  0.06     -0.10  0.32 0.54    1.18 0.84 
    #> theta_8874  0.19      0.00  0.45 0.78    3.56 0.28 
    #> theta_8946 -0.59     -0.80 -0.38 1.00     Inf 0.00 
    #> theta_8983 -0.33     -0.54 -0.10 0.98   40.67 0.02 
    #> theta_9021 -0.02     -0.20  0.11 0.48    0.91 1.09 
    #> theta_9104 -0.65     -0.88 -0.42 1.00     Inf 0.00 
    #> theta_9158 -0.41     -0.62 -0.20 0.99  128.03 0.01 
    #> theta_9198  0.10     -0.09  0.43 0.62    1.62 0.62 
    #> theta_9225  0.48      0.27  0.70 1.00  399.00 0.00 
    #> theta_9292  0.54      0.34  0.75 1.00     Inf 0.00 
    #> theta_9340 -0.06     -0.28  0.06 0.52    1.10 0.91 
    #> theta_9347  0.23      0.00  0.48 0.86    5.93 0.17 
    #> theta_9359  0.16      0.00  0.38 0.77    3.38 0.30 
    #> theta_9397  0.13     -0.05  0.44 0.67    2.04 0.49 
    #> theta_9508  0.05     -0.08  0.28 0.51    1.03 0.97 
    #> theta_9550  0.08     -0.03  0.30 0.57    1.30 0.77 
    #> theta_9586  0.08     -0.09  0.34 0.60    1.48 0.68

Building on top of SSranef models
---------------------------------

The code for each model can also be extracted to make more extensive
modifications or build more complex models

    jags_model_text <- fit$model_text
    cat(jags_model_text)
    #> model{
    #>   for (i in 1:N) {
    #>     # likelihood
    #>     y[i] ~ dnorm(alpha_j[unit[i]], precision)
    #>   }
    #>   for (j in 1:J) {
    #>     gamma[j] ~ dbern(0.75)
    #>     # non-centered parameterization
    #>     alpha_raw[j] ~ dnorm(0, 1)
    #>     theta[j] <- tau * alpha_raw[j] * gamma[j]
    #>     alpha_j[j] <- alpha + theta[j]
    #>     lambda[j] <- (tau^2 / (tau^2 + sigma^2/n_j[j])) * gamma[j]
    #>   }
    #>   alpha ~ dt(0, 1, 3)
    #>   tau ~ dt(0, 1, 3)T(0, )
    #>   precision <- pow(sigma, -2)
    #>   sigma ~ dt(0, 1, 3)T(0, )
    #> }

References
==========

Rodriguez, Josue E, Donald R Williams, and Philippe Rast. 2021. “Who Is
and Is Not" Average’"? Random Effects Selection with Spike-and-Slab
Priors.” <https://doi.org/10.31234/osf.io/4d9tv>.
