---
output: github_document
bibliography: inst/ref.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- knit with rmarkdown::render("README.Rmd", output_format = "md_document") -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  cache = FALSE
)
```

# Individual Variance Detection


<!-- badges: start -->
[![R-CMD-check](https://github.com/ph-rast/ivd/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ph-rast/ivd/actions/workflows/R-CMD-check.yaml)
[![codecov](https://codecov.io/gh/consistentlyBetter/ivd/graph/badge.svg?token=SD0PM5BVIL)](https://codecov.io/gh/consistentlyBetter/ivd)
<!-- badges: end -->

*ivd* is an R package for random effects selection in the scale part of Mixed Effects Location Scale Modlels (MELSM). `ivd()` fits a random intercepts model with a spike-and-slab prior on the random effects of the scale.

## Installation

This package can be installed with 

``` r
# install.packages("devtools")
devtools::install_github("consistentlybetter/ivd")
```

## Example


```{r example}
library(ivd)
```

## Estimate Model

```{r}
out <- ivd(location_formula = math_proficiency ~ student_ses + (1|school_id),
           scale_formula =  ~ student_ses + (1|school_id),
           data = saeb,
           niter = 2000, nburnin = 5000, WAIC = TRUE, workers = 4)
```

```{r}
summary(out)
```

## Plots

### Posterior inclusion probability plot (PIP)

```{r}
plot(out, type = "pip" )
```
### PIP vs. Within-cluster SD

```{r}
plot(out, type =  "funnel")
```

### Diagnostic plots based on coda plots:

```{r}
codaplot(out, parameter =  "beta[1]")
codaplot(out, parameter =  "R[2, 1]")
```

# References
